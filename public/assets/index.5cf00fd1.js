import{d as ct,c as Q,r as en,a as qt,w as me,o as ro,_ as M,b as O,e as Ft,u as Lt,f as nn,g as oo,P as ft,h as F,i as Bt,j as so,k as ao,l as uo,T as co,m as wt,v as Ct,A as lo,n as rn,s as on,p as Z,q as ut,t as V,x as St,y as H,z as ho,I as $t,F as fe,B as z,C as kt,D as le,E as Ht,G as fo,H as sn,J as po,K as vo,L as yo,M as Qe,N as he,O as go,Q as _o}from"./index.e558b280.js";import{u as mo}from"./school.0d2b0ff8.js";import{L as bo}from"./LineBtn.ffe0b706.js";import{c as an,L as wo,T as Co,S as So,B as ko}from"./api.77d9259c.js";import{_ as To}from"./UserOutlined.8d22b6dc.js";import{_ as xo,a as Po}from"./index.ad51bd24.js";import{P as Oo,_ as Eo,M as Ao,a as Lo}from"./index.23e6ad97.js";import{_ as Io}from"./index.a833a952.js";import{D as Ro,u as jo}from"./chat.da65f05e.js";import{T as No,_ as Do}from"./index.2bb5e9bf.js";import{C as Tt}from"./Card.57d49227.js";import{_ as Mo}from"./_plugin-vue_export-helper.cdc0426e.js";import"./Input.0cfca6ea.js";import"./styleChecker.cf36301e.js";import"./Dropdown.bb8db13b.js";import"./Col.92aa9075.js";import"./PlusOutlined.863c44e3.js";function Ke(p){var c=p.prefixCls,u=p.value,a=p.current,s=p.offset,l=s===void 0?0:s,h;return l&&(h={position:"absolute",top:"".concat(l,"00%"),left:0}),O("p",{style:h,class:Ft("".concat(c,"-only-unit"),{current:a})},[u])}function Uo(p,c,u){for(var a=p,s=0;(a+10)%10!==c;)a+=u,s+=u;return s}const qo=ct({compatConfig:{MODE:3},name:"SingleNumber",props:{prefixCls:String,value:String,count:Number},setup:function(c){var u=Q(function(){return Number(c.value)}),a=Q(function(){return Math.abs(c.count)}),s=en({prevValue:u.value,prevCount:a.value}),l=function(){s.prevValue=u.value,s.prevCount=a.value},h=qt();return me(u,function(){clearTimeout(h.value),h.value=setTimeout(function(){l()},1e3)},{flush:"post"}),ro(function(){clearTimeout(h.value)}),function(){var C,m={},L=u.value;if(s.prevValue===L||Number.isNaN(L)||Number.isNaN(s.prevValue))C=[Ke(M(M({},c),{},{current:!0}))],m={transition:"none"};else{C=[];for(var P=L+10,k=[],b=L;b<=P;b+=1)k.push(b);var w=k.findIndex(function(g){return g%10===s.prevValue});C=k.map(function(g,d){var y=g%10;return Ke(M(M({},c),{},{value:y,offset:d-w,current:d===w}))});var T=s.prevCount<a.value?1:-1;m={transform:"translateY(".concat(-Uo(s.prevValue,L,T),"00%)")}}return O("span",{class:"".concat(c.prefixCls,"-only"),style:m,onTransitionend:function(){return l()}},[C])}}});var Bo=["prefixCls","count","title","show","component","class","style"],Ho={prefixCls:String,count:ft.any,component:String,title:ft.any,show:Boolean};const zo=ct({compatConfig:{MODE:3},name:"ScrollNumber",inheritAttrs:!1,props:Ho,setup:function(c,u){var a=u.attrs,s=u.slots,l=Lt("scroll-number",c),h=l.prefixCls;return function(){var C,m=M(M({},c),a);m.prefixCls;var L=m.count,P=m.title;m.show;var k=m.component,b=k===void 0?"sup":k,w=m.class,T=m.style,g=nn(m,Bo),d=M(M({},g),{},{style:T,"data-show":c.show,class:Ft(h.value,w),title:P}),y=L;if(L&&Number(L)%1===0){var x=String(L).split("");y=x.map(function(E,N){return O(qo,{prefixCls:h.value,count:Number(L),value:E,key:x.length-N},null)})}T&&T.borderColor&&(d.style=M(M({},T),{},{boxShadow:"0 0 0 1px ".concat(T.borderColor," inset")}));var R=oo((C=s.default)===null||C===void 0?void 0:C.call(s));return R&&R.length?an(R,{class:Ft("".concat(h.value,"-custom-component"))},!1):O(b,d,{default:function(){return[y]}})}}});function At(p){return Oo.indexOf(p)!==-1}var Fo=["class","style"],$o=function(){return{prefix:String,color:{type:String},text:ft.any,placement:{type:String,default:"end"}}};const pe=ct({compatConfig:{MODE:3},name:"ABadgeRibbon",inheritAttrs:!1,props:$o(),slots:["text"],setup:function(c,u){var a=u.attrs,s=u.slots,l=Lt("ribbon",c),h=l.prefixCls,C=l.direction,m=Q(function(){return At(c.color)}),L=Q(function(){var P;return[h.value,"".concat(h.value,"-placement-").concat(c.placement),(P={},F(P,"".concat(h.value,"-rtl"),C.value==="rtl"),F(P,"".concat(h.value,"-color-").concat(c.color),m.value),P)]});return function(){var P,k,b=a.class,w=a.style,T=nn(a,Fo),g={},d={};return c.color&&!m.value&&(g.background=c.color,d.color=c.color),O("div",M({class:"".concat(h.value,"-wrapper")},T),[(P=s.default)===null||P===void 0?void 0:P.call(s),O("div",{class:[L.value,b],style:M(M({},g),w)},[O("span",{class:"".concat(h.value,"-text")},[c.text||((k=s.text)===null||k===void 0?void 0:k.call(s))]),O("div",{class:"".concat(h.value,"-corner"),style:d},null)])])}}});var Xo=function(c){return!isNaN(parseFloat(c))&&isFinite(c)};const Jo=Xo;var Wo=function(){return{count:ft.any,showZero:{type:Boolean,default:void 0},overflowCount:{type:Number,default:99},dot:{type:Boolean,default:void 0},prefixCls:String,scrollNumberPrefixCls:String,status:{type:String},size:{type:String,default:"default"},color:String,text:ft.any,offset:Array,numberStyle:{type:Object,default:void 0},title:String}};const zt=ct({compatConfig:{MODE:3},name:"ABadge",Ribbon:pe,inheritAttrs:!1,props:Wo(),slots:["text","count"],setup:function(c,u){var a=u.slots,s=u.attrs,l=Lt("badge",c),h=l.prefixCls,C=l.direction,m=Q(function(){return c.count>c.overflowCount?"".concat(c.overflowCount,"+"):c.count}),L=Q(function(){return c.status!==null&&c.status!==void 0||c.color!==null&&c.color!==void 0}),P=Q(function(){return m.value==="0"||m.value===0}),k=Q(function(){return c.dot&&!P.value}),b=Q(function(){return k.value?"":m.value}),w=Q(function(){var E=b.value===null||b.value===void 0||b.value==="";return(E||P.value&&!c.showZero)&&!k.value}),T=qt(c.count),g=qt(b.value),d=qt(k.value);me([function(){return c.count},b,k],function(){w.value||(T.value=c.count,g.value=b.value,d.value=k.value)},{immediate:!0});var y=Q(function(){var E;return E={},F(E,"".concat(h.value,"-status-dot"),L.value),F(E,"".concat(h.value,"-status-").concat(c.status),!!c.status),F(E,"".concat(h.value,"-status-").concat(c.color),At(c.color)),E}),x=Q(function(){return c.color&&!At(c.color)?{background:c.color}:{}}),R=Q(function(){var E;return E={},F(E,"".concat(h.value,"-dot"),d.value),F(E,"".concat(h.value,"-count"),!d.value),F(E,"".concat(h.value,"-count-sm"),c.size==="small"),F(E,"".concat(h.value,"-multiple-words"),!d.value&&g.value&&g.value.toString().length>1),F(E,"".concat(h.value,"-status-").concat(c.status),!!c.status),F(E,"".concat(h.value,"-status-").concat(c.color),At(c.color)),E});return function(){var E,N,j,q=c.offset,U=c.title,W=c.color,K=s.style,xt=Bt(a,c,"text"),it=h.value,nt=T.value,Y=so((E=a.default)===null||E===void 0?void 0:E.call(a));Y=Y.length?Y:null;var lt=!!(!w.value||a.count),yt=function(){if(!q)return M({},K);var _t={marginTop:Jo(q[1])?"".concat(q[1],"px"):q[1]};return C.value==="rtl"?_t.left="".concat(parseInt(q[0],10),"px"):_t.right="".concat(-parseInt(q[0],10),"px"),M(M({},_t),K)}(),Vt=U!=null?U:typeof nt=="string"||typeof nt=="number"?nt:void 0,Gt=lt||!xt?null:O("span",{class:"".concat(it,"-status-text")},[xt]),Qt=ao(nt)==="object"||nt===void 0&&a.count?an(nt!=null?nt:(N=a.count)===null||N===void 0?void 0:N.call(a),{style:yt},!1):null,It=Ft(it,(j={},F(j,"".concat(it,"-status"),L.value),F(j,"".concat(it,"-not-a-wrapper"),!Y),F(j,"".concat(it,"-rtl"),C.value==="rtl"),j),s.class);if(!Y&&L.value){var Rt=yt.color;return O("span",M(M({},s),{},{class:It,style:yt}),[O("span",{class:y.value,style:x.value},null),O("span",{style:{color:Rt},class:"".concat(it,"-status-text")},[xt])])}var jt=uo(Y?"".concat(it,"-zoom"):"",{appear:!1}),gt=M(M({},yt),c.numberStyle);return W&&!At(W)&&(gt=gt||{},gt.background=W),O("span",M(M({},s),{},{class:It}),[Y,O(co,jt,{default:function(){return[wt(O(zo,{prefixCls:c.scrollNumberPrefixCls,show:lt,class:R.value,count:g.value,title:Vt,style:gt,key:"scrollNumber"},{default:function(){return[Qt]}}),[[Ct,lt]])]}}),Gt])}}});zt.install=function(p){return p.component(zt.name,zt),p.component(pe.name,pe),p};var Vo=function(){return{prefixCls:String,title:ft.any,description:ft.any,avatar:ft.any}};const de=ct({compatConfig:{MODE:3},name:"ACardMeta",props:Vo(),slots:["title","description","avatar"],setup:function(c,u){var a=u.slots,s=Lt("card",c),l=s.prefixCls;return function(){var h=F({},"".concat(l.value,"-meta"),!0),C=Bt(a,c,"avatar"),m=Bt(a,c,"title"),L=Bt(a,c,"description"),P=C?O("div",{class:"".concat(l.value,"-meta-avatar")},[C]):null,k=m?O("div",{class:"".concat(l.value,"-meta-title")},[m]):null,b=L?O("div",{class:"".concat(l.value,"-meta-description")},[L]):null,w=k||b?O("div",{class:"".concat(l.value,"-meta-detail")},[k,b]):null;return O("div",{class:h},[P,w])}}});var Go=function(){return{prefixCls:String,hoverable:{type:Boolean,default:!0}}};const ve=ct({compatConfig:{MODE:3},name:"ACardGrid",__ANT_CARD_GRID:!0,props:Go(),setup:function(c,u){var a=u.slots,s=Lt("card",c),l=s.prefixCls,h=Q(function(){var C;return C={},F(C,"".concat(l.value,"-grid"),!0),F(C,"".concat(l.value,"-grid-hoverable"),c.hoverable),C});return function(){var C;return O("div",{class:h.value},[(C=a.default)===null||C===void 0?void 0:C.call(a)])}}});Tt.Meta=de;Tt.Grid=ve;Tt.install=function(p){return p.component(Tt.name,Tt),p.component(de.name,de),p.component(ve.name,ve),p};var Qo={icon:function(c,u){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:c}},{tag:"path",attrs:{d:"M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm192 396c0 4.4-3.6 8-8 8H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h368c4.4 0 8 3.6 8 8v48z",fill:u}},{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z",fill:c}}]}},name:"minus-circle",theme:"twotone"};const Ko=Qo;function Ye(p){for(var c=1;c<arguments.length;c++){var u=arguments[c]!=null?Object(arguments[c]):{},a=Object.keys(u);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(u).filter(function(s){return Object.getOwnPropertyDescriptor(u,s).enumerable}))),a.forEach(function(s){Yo(p,s,u[s])})}return p}function Yo(p,c,u){return c in p?Object.defineProperty(p,c,{value:u,enumerable:!0,configurable:!0,writable:!0}):p[c]=u,p}var be=function(c,u){var a=Ye({},c,u.attrs);return O(lo,Ye({},a,{icon:Ko}),null)};be.displayName="MinusCircleTwoTone";be.inheritAttrs=!1;const Zo=be,ts={class:"h-12 bg-[#1e40af] text-white flex justify-between items-center px-5 absolute top-0 left-0 w-full z-10"},es={class:"text-white flex items-center"},ns={class:"text-base font-bold"},rs={key:0,class:"text-xs ml-4"},is=V("span",{class:"mx-1"},"/",-1),os={class:"ant-dropdown-link cursor-pointer"},ss=V("span",null,"\u89E3\u7ED1Line",-1),as=ct({__name:"PageHeader",setup(p){const c=rn(),{curSchool:u}=on(mo());function a(){wo.unBind({identity:c.identity}).then(()=>{fo.success("\u89E3\u7ED1\u6210\u529F"),c.setBindLine(!1)})}return(s,l)=>{const h=sn("router-link"),C=To,m=xo,L=Eo,P=Io,k=Ao,b=Ro;return Z(),ut("div",ts,[V("div",es,[V("div",ns,St(H(ho)),1),H(u)?(Z(),ut("div",rs,[H(c).identity==H($t).Teacher?(Z(),ut(fe,{key:0},[O(h,{to:"/schools",replace:"",class:"text-slate-400 hover:text-blue cursor-pointer"},{default:z(()=>[kt("\u5168\u90E8\u5B66\u6821")]),_:1}),is],64)):le("",!0),V("span",null,St(H(u).name),1)])):le("",!0)]),O(b,null,{overlay:z(()=>[O(k,null,{default:z(()=>[H(c).identity==H($t).Teacher?(Z(),Ht(L,{key:0},{default:z(()=>[O(h,{to:"/fans"},{default:z(()=>[kt("\u7C89\u4E1D\u5217\u8868")]),_:1})]),_:1})):le("",!0),O(L,null,{default:z(()=>[H(c).bindLine?(Z(),Ht(P,{key:1,title:"\u89E3\u7ED1\u4E4B\u540E\u5C06\u4E0D\u53EF\u4F7F\u7528Line\u8D26\u53F7\u767B\u5F55\uFF0C\u786E\u5B9A\u89E3\u7ED1\u5417\uFF1F","ok-text":"\u786E\u5B9A","cancel-text":"\u53D6\u6D88",onConfirm:a},{default:z(()=>[ss]),_:1})):(Z(),Ht(bo,{key:0,"is-text":""}))]),_:1}),O(L,null,{default:z(()=>[V("span",{onClick:l[0]||(l[0]=w=>H(c).logout())},"\u9000\u51FA\u767B\u5F55")]),_:1})]),_:1})]),default:z(()=>[V("span",os,[O(C),kt(" "+St(H(c).name)+" ",1),O(m)])]),_:1})])}}});var un={exports:{}};/*!
 * Pusher JavaScript Library v8.0.1
 * https://pusher.com/
 *
 * Copyright 2020, Pusher
 * Released under the MIT licence.
 */(function(p,c){(function(a,s){p.exports=s()})(window,function(){return function(u){var a={};function s(l){if(a[l])return a[l].exports;var h=a[l]={i:l,l:!1,exports:{}};return u[l].call(h.exports,h,h.exports,s),h.l=!0,h.exports}return s.m=u,s.c=a,s.d=function(l,h,C){s.o(l,h)||Object.defineProperty(l,h,{enumerable:!0,get:C})},s.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},s.t=function(l,h){if(h&1&&(l=s(l)),h&8||h&4&&typeof l=="object"&&l&&l.__esModule)return l;var C=Object.create(null);if(s.r(C),Object.defineProperty(C,"default",{enumerable:!0,value:l}),h&2&&typeof l!="string")for(var m in l)s.d(C,m,function(L){return l[L]}.bind(null,m));return C},s.n=function(l){var h=l&&l.__esModule?function(){return l.default}:function(){return l};return s.d(h,"a",h),h},s.o=function(l,h){return Object.prototype.hasOwnProperty.call(l,h)},s.p="",s(s.s=2)}([function(u,a,s){var l=this&&this.__extends||function(){var g=function(d,y){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,R){x.__proto__=R}||function(x,R){for(var E in R)R.hasOwnProperty(E)&&(x[E]=R[E])},g(d,y)};return function(d,y){g(d,y);function x(){this.constructor=d}d.prototype=y===null?Object.create(y):(x.prototype=y.prototype,new x)}}();Object.defineProperty(a,"__esModule",{value:!0});var h=256,C=function(){function g(d){d===void 0&&(d="="),this._paddingCharacter=d}return g.prototype.encodedLength=function(d){return this._paddingCharacter?(d+2)/3*4|0:(d*8+5)/6|0},g.prototype.encode=function(d){for(var y="",x=0;x<d.length-2;x+=3){var R=d[x]<<16|d[x+1]<<8|d[x+2];y+=this._encodeByte(R>>>3*6&63),y+=this._encodeByte(R>>>2*6&63),y+=this._encodeByte(R>>>1*6&63),y+=this._encodeByte(R>>>0*6&63)}var E=d.length-x;if(E>0){var R=d[x]<<16|(E===2?d[x+1]<<8:0);y+=this._encodeByte(R>>>3*6&63),y+=this._encodeByte(R>>>2*6&63),E===2?y+=this._encodeByte(R>>>1*6&63):y+=this._paddingCharacter||"",y+=this._paddingCharacter||""}return y},g.prototype.maxDecodedLength=function(d){return this._paddingCharacter?d/4*3|0:(d*6+7)/8|0},g.prototype.decodedLength=function(d){return this.maxDecodedLength(d.length-this._getPaddingLength(d))},g.prototype.decode=function(d){if(d.length===0)return new Uint8Array(0);for(var y=this._getPaddingLength(d),x=d.length-y,R=new Uint8Array(this.maxDecodedLength(x)),E=0,N=0,j=0,q=0,U=0,W=0,K=0;N<x-4;N+=4)q=this._decodeChar(d.charCodeAt(N+0)),U=this._decodeChar(d.charCodeAt(N+1)),W=this._decodeChar(d.charCodeAt(N+2)),K=this._decodeChar(d.charCodeAt(N+3)),R[E++]=q<<2|U>>>4,R[E++]=U<<4|W>>>2,R[E++]=W<<6|K,j|=q&h,j|=U&h,j|=W&h,j|=K&h;if(N<x-1&&(q=this._decodeChar(d.charCodeAt(N)),U=this._decodeChar(d.charCodeAt(N+1)),R[E++]=q<<2|U>>>4,j|=q&h,j|=U&h),N<x-2&&(W=this._decodeChar(d.charCodeAt(N+2)),R[E++]=U<<4|W>>>2,j|=W&h),N<x-3&&(K=this._decodeChar(d.charCodeAt(N+3)),R[E++]=W<<6|K,j|=K&h),j!==0)throw new Error("Base64Coder: incorrect characters for decoding");return R},g.prototype._encodeByte=function(d){var y=d;return y+=65,y+=25-d>>>8&0-65-26+97,y+=51-d>>>8&26-97-52+48,y+=61-d>>>8&52-48-62+43,y+=62-d>>>8&62-43-63+47,String.fromCharCode(y)},g.prototype._decodeChar=function(d){var y=h;return y+=(42-d&d-44)>>>8&-h+d-43+62,y+=(46-d&d-48)>>>8&-h+d-47+63,y+=(47-d&d-58)>>>8&-h+d-48+52,y+=(64-d&d-91)>>>8&-h+d-65+0,y+=(96-d&d-123)>>>8&-h+d-97+26,y},g.prototype._getPaddingLength=function(d){var y=0;if(this._paddingCharacter){for(var x=d.length-1;x>=0&&d[x]===this._paddingCharacter;x--)y++;if(d.length<4||y>2)throw new Error("Base64Coder: incorrect padding")}return y},g}();a.Coder=C;var m=new C;function L(g){return m.encode(g)}a.encode=L;function P(g){return m.decode(g)}a.decode=P;var k=function(g){l(d,g);function d(){return g!==null&&g.apply(this,arguments)||this}return d.prototype._encodeByte=function(y){var x=y;return x+=65,x+=25-y>>>8&0-65-26+97,x+=51-y>>>8&26-97-52+48,x+=61-y>>>8&52-48-62+45,x+=62-y>>>8&62-45-63+95,String.fromCharCode(x)},d.prototype._decodeChar=function(y){var x=h;return x+=(44-y&y-46)>>>8&-h+y-45+62,x+=(94-y&y-96)>>>8&-h+y-95+63,x+=(47-y&y-58)>>>8&-h+y-48+52,x+=(64-y&y-91)>>>8&-h+y-65+0,x+=(96-y&y-123)>>>8&-h+y-97+26,x},d}(C);a.URLSafeCoder=k;var b=new k;function w(g){return b.encode(g)}a.encodeURLSafe=w;function T(g){return b.decode(g)}a.decodeURLSafe=T,a.encodedLength=function(g){return m.encodedLength(g)},a.maxDecodedLength=function(g){return m.maxDecodedLength(g)},a.decodedLength=function(g){return m.decodedLength(g)}},function(u,a,s){Object.defineProperty(a,"__esModule",{value:!0});var l="utf8: invalid string",h="utf8: invalid source encoding";function C(P){for(var k=new Uint8Array(m(P)),b=0,w=0;w<P.length;w++){var T=P.charCodeAt(w);T<128?k[b++]=T:T<2048?(k[b++]=192|T>>6,k[b++]=128|T&63):T<55296?(k[b++]=224|T>>12,k[b++]=128|T>>6&63,k[b++]=128|T&63):(w++,T=(T&1023)<<10,T|=P.charCodeAt(w)&1023,T+=65536,k[b++]=240|T>>18,k[b++]=128|T>>12&63,k[b++]=128|T>>6&63,k[b++]=128|T&63)}return k}a.encode=C;function m(P){for(var k=0,b=0;b<P.length;b++){var w=P.charCodeAt(b);if(w<128)k+=1;else if(w<2048)k+=2;else if(w<55296)k+=3;else if(w<=57343){if(b>=P.length-1)throw new Error(l);b++,k+=4}else throw new Error(l)}return k}a.encodedLength=m;function L(P){for(var k=[],b=0;b<P.length;b++){var w=P[b];if(w&128){var T=void 0;if(w<224){if(b>=P.length)throw new Error(h);var g=P[++b];if((g&192)!==128)throw new Error(h);w=(w&31)<<6|g&63,T=128}else if(w<240){if(b>=P.length-1)throw new Error(h);var g=P[++b],d=P[++b];if((g&192)!==128||(d&192)!==128)throw new Error(h);w=(w&15)<<12|(g&63)<<6|d&63,T=2048}else if(w<248){if(b>=P.length-2)throw new Error(h);var g=P[++b],d=P[++b],y=P[++b];if((g&192)!==128||(d&192)!==128||(y&192)!==128)throw new Error(h);w=(w&15)<<18|(g&63)<<12|(d&63)<<6|y&63,T=65536}else throw new Error(h);if(w<T||w>=55296&&w<=57343)throw new Error(h);if(w>=65536){if(w>1114111)throw new Error(h);w-=65536,k.push(String.fromCharCode(55296|w>>10)),w=56320|w&1023}}k.push(String.fromCharCode(w))}return k.join("")}a.decode=L},function(u,a,s){u.exports=s(3).default},function(u,a,s){s.r(a);var l=function(){function e(t,n){this.lastId=0,this.prefix=t,this.name=n}return e.prototype.create=function(t){this.lastId++;var n=this.lastId,r=this.prefix+n,i=this.name+"["+n+"]",o=!1,f=function(){o||(t.apply(null,arguments),o=!0)};return this[n]=f,{number:n,id:r,name:i,callback:f}},e.prototype.remove=function(t){delete this[t.number]},e}(),h=new l("_pusher_script_","Pusher.ScriptReceivers"),C={VERSION:"8.0.1",PROTOCOL:7,wsPort:80,wssPort:443,wsPath:"",httpHost:"sockjs.pusher.com",httpPort:80,httpsPort:443,httpPath:"/pusher",stats_host:"stats.pusher.com",authEndpoint:"/pusher/auth",authTransport:"ajax",activityTimeout:12e4,pongTimeout:3e4,unavailableTimeout:1e4,userAuthentication:{endpoint:"/pusher/user-auth",transport:"ajax"},channelAuthorization:{endpoint:"/pusher/auth",transport:"ajax"},cdn_http:"http://js.pusher.com",cdn_https:"https://js.pusher.com",dependency_suffix:""},m=C,L=function(){function e(t){this.options=t,this.receivers=t.receivers||h,this.loading={}}return e.prototype.load=function(t,n,r){var i=this;if(i.loading[t]&&i.loading[t].length>0)i.loading[t].push(r);else{i.loading[t]=[r];var o=A.createScriptRequest(i.getPath(t,n)),f=i.receivers.create(function(v){if(i.receivers.remove(f),i.loading[t]){var S=i.loading[t];delete i.loading[t];for(var _=function(B){B||o.cleanup()},I=0;I<S.length;I++)S[I](v,_)}});o.send(f)}},e.prototype.getRoot=function(t){var n,r=A.getDocument().location.protocol;return t&&t.useTLS||r==="https:"?n=this.options.cdn_https:n=this.options.cdn_http,n.replace(/\/*$/,"")+"/"+this.options.version},e.prototype.getPath=function(t,n){return this.getRoot(n)+"/"+t+this.options.suffix+".js"},e}(),P=L,k=new l("_pusher_dependencies","Pusher.DependenciesReceivers"),b=new P({cdn_http:m.cdn_http,cdn_https:m.cdn_https,version:m.VERSION,suffix:m.dependency_suffix,receivers:k}),w={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/channels/server_api/authenticating_users"},authorizationEndpoint:{path:"/docs/channels/server_api/authorizing-users/"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"},encryptedChannelSupport:{fullUrl:"https://github.com/pusher/pusher-js/tree/cc491015371a4bde5743d1c87a0fbac0feb53195#encrypted-channel-support"}}},T=function(e){var t="See:",n=w.urls[e];if(!n)return"";var r;return n.fullUrl?r=n.fullUrl:n.path&&(r=w.baseUrl+n.path),r?t+" "+r:""},g={buildLogSuffix:T},d;(function(e){e.UserAuthentication="user-authentication",e.ChannelAuthorization="channel-authorization"})(d||(d={}));var y=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),x=function(e){y(t,e);function t(n){var r=this.constructor,i=e.call(this,n)||this;return Object.setPrototypeOf(i,r.prototype),i}return t}(Error),R=function(e){y(t,e);function t(n){var r=this.constructor,i=e.call(this,n)||this;return Object.setPrototypeOf(i,r.prototype),i}return t}(Error),E=function(e){y(t,e);function t(n){var r=this.constructor,i=e.call(this,n)||this;return Object.setPrototypeOf(i,r.prototype),i}return t}(Error),N=function(e){y(t,e);function t(n){var r=this.constructor,i=e.call(this,n)||this;return Object.setPrototypeOf(i,r.prototype),i}return t}(Error),j=function(e){y(t,e);function t(n){var r=this.constructor,i=e.call(this,n)||this;return Object.setPrototypeOf(i,r.prototype),i}return t}(Error),q=function(e){y(t,e);function t(n){var r=this.constructor,i=e.call(this,n)||this;return Object.setPrototypeOf(i,r.prototype),i}return t}(Error),U=function(e){y(t,e);function t(n){var r=this.constructor,i=e.call(this,n)||this;return Object.setPrototypeOf(i,r.prototype),i}return t}(Error),W=function(e){y(t,e);function t(n){var r=this.constructor,i=e.call(this,n)||this;return Object.setPrototypeOf(i,r.prototype),i}return t}(Error),K=function(e){y(t,e);function t(n,r){var i=this.constructor,o=e.call(this,r)||this;return o.status=n,Object.setPrototypeOf(o,i.prototype),o}return t}(Error),xt=function(e,t,n,r,i){var o=A.createXHR();o.open("POST",n.endpoint,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var f in n.headers)o.setRequestHeader(f,n.headers[f]);if(n.headersProvider!=null){var v=n.headersProvider();for(var f in v)o.setRequestHeader(f,v[f])}return o.onreadystatechange=function(){if(o.readyState===4)if(o.status===200){var S=void 0,_=!1;try{S=JSON.parse(o.responseText),_=!0}catch{i(new K(200,"JSON returned from "+r.toString()+" endpoint was invalid, yet status code was 200. Data was: "+o.responseText),null)}_&&i(null,S)}else{var I="";switch(r){case d.UserAuthentication:I=g.buildLogSuffix("authenticationEndpoint");break;case d.ChannelAuthorization:I="Clients must be authorized to join private or presence channels. "+g.buildLogSuffix("authorizationEndpoint");break}i(new K(o.status,"Unable to retrieve auth string from "+r.toString()+" endpoint - "+("received status: "+o.status+" from "+n.endpoint+". "+I)),null)}},o.send(t),o},it=xt;function nt(e){return Qt(Vt(e))}var Y=String.fromCharCode,lt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yt=function(e){var t=e.charCodeAt(0);return t<128?e:t<2048?Y(192|t>>>6)+Y(128|t&63):Y(224|t>>>12&15)+Y(128|t>>>6&63)+Y(128|t&63)},Vt=function(e){return e.replace(/[^\x00-\x7F]/g,yt)},Gt=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0),r=[lt.charAt(n>>>18),lt.charAt(n>>>12&63),t>=2?"=":lt.charAt(n>>>6&63),t>=1?"=":lt.charAt(n&63)];return r.join("")},Qt=window.btoa||function(e){return e.replace(/[\s\S]{1,3}/g,Gt)},It=function(){function e(t,n,r,i){var o=this;this.clear=n,this.timer=t(function(){o.timer&&(o.timer=i(o.timer))},r)}return e.prototype.isRunning=function(){return this.timer!==null},e.prototype.ensureAborted=function(){this.timer&&(this.clear(this.timer),this.timer=null)},e}(),Rt=It,jt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();function gt(e){window.clearTimeout(e)}function _t(e){window.clearInterval(e)}var ht=function(e){jt(t,e);function t(n,r){return e.call(this,setTimeout,gt,n,function(i){return r(),null})||this}return t}(Rt),fn=function(e){jt(t,e);function t(n,r){return e.call(this,setInterval,_t,n,function(i){return r(),i})||this}return t}(Rt),pn={now:function(){return Date.now?Date.now():new Date().valueOf()},defer:function(e){return new ht(0,e)},method:function(e){var t=Array.prototype.slice.call(arguments,1);return function(n){return n[e].apply(n,t.concat(arguments))}}},J=pn;function G(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++){var i=t[r];for(var o in i)i[o]&&i[o].constructor&&i[o].constructor===Object?e[o]=G(e[o]||{},i[o]):e[o]=i[o]}return e}function dn(){for(var e=["Pusher"],t=0;t<arguments.length;t++)typeof arguments[t]=="string"?e.push(arguments[t]):e.push(Nt(arguments[t]));return e.join(" : ")}function Se(e,t){var n=Array.prototype.indexOf;if(e===null)return-1;if(n&&e.indexOf===n)return e.indexOf(t);for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1}function ot(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(e[n],n,e)}function ke(e){var t=[];return ot(e,function(n,r){t.push(r)}),t}function vn(e){var t=[];return ot(e,function(n){t.push(n)}),t}function Pt(e,t,n){for(var r=0;r<e.length;r++)t.call(n||window,e[r],r,e)}function Te(e,t){for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r,e,n));return n}function yn(e,t){var n={};return ot(e,function(r,i){n[i]=t(r)}),n}function xe(e,t){t=t||function(i){return!!i};for(var n=[],r=0;r<e.length;r++)t(e[r],r,e,n)&&n.push(e[r]);return n}function Pe(e,t){var n={};return ot(e,function(r,i){(t&&t(r,i,e,n)||Boolean(r))&&(n[i]=r)}),n}function gn(e){var t=[];return ot(e,function(n,r){t.push([r,n])}),t}function Oe(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n,e))return!0;return!1}function _n(e,t){for(var n=0;n<e.length;n++)if(!t(e[n],n,e))return!1;return!0}function mn(e){return yn(e,function(t){return typeof t=="object"&&(t=Nt(t)),encodeURIComponent(nt(t.toString()))})}function bn(e){var t=Pe(e,function(r){return r!==void 0}),n=Te(gn(mn(t)),J.method("join","=")).join("&");return n}function wn(e){var t=[],n=[];return function r(i,o){var f,v,S;switch(typeof i){case"object":if(!i)return null;for(f=0;f<t.length;f+=1)if(t[f]===i)return{$ref:n[f]};if(t.push(i),n.push(o),Object.prototype.toString.apply(i)==="[object Array]")for(S=[],f=0;f<i.length;f+=1)S[f]=r(i[f],o+"["+f+"]");else{S={};for(v in i)Object.prototype.hasOwnProperty.call(i,v)&&(S[v]=r(i[v],o+"["+JSON.stringify(v)+"]"))}return S;case"number":case"string":case"boolean":return i}}(e,"$")}function Nt(e){try{return JSON.stringify(e)}catch{return JSON.stringify(wn(e))}}var Cn=function(){function e(){this.globalLog=function(t){window.console&&window.console.log&&window.console.log(t)}}return e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.log(this.globalLog,t)},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.log(this.globalLogWarn,t)},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.log(this.globalLogError,t)},e.prototype.globalLogWarn=function(t){window.console&&window.console.warn?window.console.warn(t):this.globalLog(t)},e.prototype.globalLogError=function(t){window.console&&window.console.error?window.console.error(t):this.globalLogWarn(t)},e.prototype.log=function(t){var n=dn.apply(this,arguments);if(ae.log)ae.log(n);else if(ae.logToConsole){var r=t.bind(this);r(n)}},e}(),D=new Cn,Sn=function(e,t,n,r,i){(n.headers!==void 0||n.headersProvider!=null)&&D.warn("To send headers with the "+r.toString()+" request, you must use AJAX, rather than JSONP.");var o=e.nextAuthCallbackID.toString();e.nextAuthCallbackID++;var f=e.getDocument(),v=f.createElement("script");e.auth_callbacks[o]=function(I){i(null,I)};var S="Pusher.auth_callbacks['"+o+"']";v.src=n.endpoint+"?callback="+encodeURIComponent(S)+"&"+t;var _=f.getElementsByTagName("head")[0]||f.documentElement;_.insertBefore(v,_.firstChild)},kn=Sn,Tn=function(){function e(t){this.src=t}return e.prototype.send=function(t){var n=this,r="Error loading "+n.src;n.script=document.createElement("script"),n.script.id=t.id,n.script.src=n.src,n.script.type="text/javascript",n.script.charset="UTF-8",n.script.addEventListener?(n.script.onerror=function(){t.callback(r)},n.script.onload=function(){t.callback(null)}):n.script.onreadystatechange=function(){(n.script.readyState==="loaded"||n.script.readyState==="complete")&&t.callback(null)},n.script.async===void 0&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(n.errorScript=document.createElement("script"),n.errorScript.id=t.id+"_error",n.errorScript.text=t.name+"('"+r+"');",n.script.async=n.errorScript.async=!1):n.script.async=!0;var i=document.getElementsByTagName("head")[0];i.insertBefore(n.script,i.firstChild),n.errorScript&&i.insertBefore(n.errorScript,n.script.nextSibling)},e.prototype.cleanup=function(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.script=null,this.errorScript=null},e}(),xn=Tn,Pn=function(){function e(t,n){this.url=t,this.data=n}return e.prototype.send=function(t){if(!this.request){var n=bn(this.data),r=this.url+"/"+t.number+"?"+n;this.request=A.createScriptRequest(r),this.request.send(t)}},e.prototype.cleanup=function(){this.request&&this.request.cleanup()},e}(),On=Pn,En=function(e,t){return function(n,r){var i="http"+(t?"s":"")+"://",o=i+(e.host||e.options.host)+e.options.path,f=A.createJSONPRequest(o,n),v=A.ScriptReceivers.create(function(S,_){h.remove(v),f.cleanup(),_&&_.host&&(e.host=_.host),r&&r(S,_)});f.send(v)}},An={name:"jsonp",getAgent:En},Ln=An;function Kt(e,t,n){var r=e+(t.useTLS?"s":""),i=t.useTLS?t.hostTLS:t.hostNonTLS;return r+"://"+i+n}function Yt(e,t){var n="/app/"+e,r="?protocol="+m.PROTOCOL+"&client=js&version="+m.VERSION+(t?"&"+t:"");return n+r}var In={getInitial:function(e,t){var n=(t.httpPath||"")+Yt(e,"flash=false");return Kt("ws",t,n)}},Rn={getInitial:function(e,t){var n=(t.httpPath||"/pusher")+Yt(e);return Kt("http",t,n)}},jn={getInitial:function(e,t){return Kt("http",t,t.httpPath||"/pusher")},getPath:function(e,t){return Yt(e)}},Nn=function(){function e(){this._callbacks={}}return e.prototype.get=function(t){return this._callbacks[Zt(t)]},e.prototype.add=function(t,n,r){var i=Zt(t);this._callbacks[i]=this._callbacks[i]||[],this._callbacks[i].push({fn:n,context:r})},e.prototype.remove=function(t,n,r){if(!t&&!n&&!r){this._callbacks={};return}var i=t?[Zt(t)]:ke(this._callbacks);n||r?this.removeCallback(i,n,r):this.removeAllCallbacks(i)},e.prototype.removeCallback=function(t,n,r){Pt(t,function(i){this._callbacks[i]=xe(this._callbacks[i]||[],function(o){return n&&n!==o.fn||r&&r!==o.context}),this._callbacks[i].length===0&&delete this._callbacks[i]},this)},e.prototype.removeAllCallbacks=function(t){Pt(t,function(n){delete this._callbacks[n]},this)},e}(),Dn=Nn;function Zt(e){return"_"+e}var Mn=function(){function e(t){this.callbacks=new Dn,this.global_callbacks=[],this.failThrough=t}return e.prototype.bind=function(t,n,r){return this.callbacks.add(t,n,r),this},e.prototype.bind_global=function(t){return this.global_callbacks.push(t),this},e.prototype.unbind=function(t,n,r){return this.callbacks.remove(t,n,r),this},e.prototype.unbind_global=function(t){return t?(this.global_callbacks=xe(this.global_callbacks||[],function(n){return n!==t}),this):(this.global_callbacks=[],this)},e.prototype.unbind_all=function(){return this.unbind(),this.unbind_global(),this},e.prototype.emit=function(t,n,r){for(var i=0;i<this.global_callbacks.length;i++)this.global_callbacks[i](t,n);var o=this.callbacks.get(t),f=[];if(r?f.push(n,r):n&&f.push(n),o&&o.length>0)for(var i=0;i<o.length;i++)o[i].fn.apply(o[i].context||window,f);else this.failThrough&&this.failThrough(t,n);return this},e}(),st=Mn,Un=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),qn=function(e){Un(t,e);function t(n,r,i,o,f){var v=e.call(this)||this;return v.initialize=A.transportConnectionInitializer,v.hooks=n,v.name=r,v.priority=i,v.key=o,v.options=f,v.state="new",v.timeline=f.timeline,v.activityTimeout=f.activityTimeout,v.id=v.timeline.generateUniqueID(),v}return t.prototype.handlesActivityChecks=function(){return Boolean(this.hooks.handlesActivityChecks)},t.prototype.supportsPing=function(){return Boolean(this.hooks.supportsPing)},t.prototype.connect=function(){var n=this;if(this.socket||this.state!=="initialized")return!1;var r=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(r,this.options)}catch(i){return J.defer(function(){n.onError(i),n.changeState("closed")}),!1}return this.bindListeners(),D.debug("Connecting",{transport:this.name,url:r}),this.changeState("connecting"),!0},t.prototype.close=function(){return this.socket?(this.socket.close(),!0):!1},t.prototype.send=function(n){var r=this;return this.state==="open"?(J.defer(function(){r.socket&&r.socket.send(n)}),!0):!1},t.prototype.ping=function(){this.state==="open"&&this.supportsPing()&&this.socket.ping()},t.prototype.onOpen=function(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0},t.prototype.onError=function(n){this.emit("error",{type:"WebSocketError",error:n}),this.timeline.error(this.buildTimelineMessage({error:n.toString()}))},t.prototype.onClose=function(n){n?this.changeState("closed",{code:n.code,reason:n.reason,wasClean:n.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0},t.prototype.onMessage=function(n){this.emit("message",n)},t.prototype.onActivity=function(){this.emit("activity")},t.prototype.bindListeners=function(){var n=this;this.socket.onopen=function(){n.onOpen()},this.socket.onerror=function(r){n.onError(r)},this.socket.onclose=function(r){n.onClose(r)},this.socket.onmessage=function(r){n.onMessage(r)},this.supportsPing()&&(this.socket.onactivity=function(){n.onActivity()})},t.prototype.unbindListeners=function(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))},t.prototype.changeState=function(n,r){this.state=n,this.timeline.info(this.buildTimelineMessage({state:n,params:r})),this.emit(n,r)},t.prototype.buildTimelineMessage=function(n){return G({cid:this.id},n)},t}(st),Bn=qn,Hn=function(){function e(t){this.hooks=t}return e.prototype.isSupported=function(t){return this.hooks.isSupported(t)},e.prototype.createConnection=function(t,n,r,i){return new Bn(this.hooks,t,n,r,i)},e}(),mt=Hn,zn=new mt({urls:In,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return Boolean(A.getWebSocketAPI())},isSupported:function(){return Boolean(A.getWebSocketAPI())},getSocket:function(e){return A.createWebSocket(e)}}),Ee={urls:Rn,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},Ae=G({getSocket:function(e){return A.HTTPFactory.createStreamingSocket(e)}},Ee),Le=G({getSocket:function(e){return A.HTTPFactory.createPollingSocket(e)}},Ee),Ie={isSupported:function(){return A.isXHRSupported()}},Fn=new mt(G({},Ae,Ie)),$n=new mt(G({},Le,Ie)),Xn={ws:zn,xhr_streaming:Fn,xhr_polling:$n},Dt=Xn,Jn=new mt({file:"sockjs",urls:jn,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return window.SockJS!==void 0},getSocket:function(e,t){return new window.SockJS(e,null,{js_path:b.getPath("sockjs",{useTLS:t.useTLS}),ignore_null_origin:t.ignoreNullOrigin})},beforeOpen:function(e,t){e.send(JSON.stringify({path:t}))}}),Re={isSupported:function(e){var t=A.isXDRSupported(e.useTLS);return t}},Wn=new mt(G({},Ae,Re)),Vn=new mt(G({},Le,Re));Dt.xdr_streaming=Wn,Dt.xdr_polling=Vn,Dt.sockjs=Jn;var Gn=Dt,Qn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kn=function(e){Qn(t,e);function t(){var n=e.call(this)||this,r=n;return window.addEventListener!==void 0&&(window.addEventListener("online",function(){r.emit("online")},!1),window.addEventListener("offline",function(){r.emit("offline")},!1)),n}return t.prototype.isOnline=function(){return window.navigator.onLine===void 0?!0:window.navigator.onLine},t}(st),Yn=new Kn,Zn=function(){function e(t,n,r){this.manager=t,this.transport=n,this.minPingDelay=r.minPingDelay,this.maxPingDelay=r.maxPingDelay,this.pingDelay=void 0}return e.prototype.createConnection=function(t,n,r,i){var o=this;i=G({},i,{activityTimeout:this.pingDelay});var f=this.transport.createConnection(t,n,r,i),v=null,S=function(){f.unbind("open",S),f.bind("closed",_),v=J.now()},_=function(I){if(f.unbind("closed",_),I.code===1002||I.code===1003)o.manager.reportDeath();else if(!I.wasClean&&v){var B=J.now()-v;B<2*o.maxPingDelay&&(o.manager.reportDeath(),o.pingDelay=Math.max(B/2,o.minPingDelay))}};return f.bind("open",S),f},e.prototype.isSupported=function(t){return this.manager.isAlive()&&this.transport.isSupported(t)},e}(),tr=Zn,je={decodeMessage:function(e){try{var t=JSON.parse(e.data),n=t.data;if(typeof n=="string")try{n=JSON.parse(t.data)}catch{}var r={event:t.event,channel:t.channel,data:n};return t.user_id&&(r.user_id=t.user_id),r}catch(i){throw{type:"MessageParseError",error:i,data:e.data}}},encodeMessage:function(e){return JSON.stringify(e)},processHandshake:function(e){var t=je.decodeMessage(e);if(t.event==="pusher:connection_established"){if(!t.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:t.data.socket_id,activityTimeout:t.data.activity_timeout*1e3}}else{if(t.event==="pusher:error")return{action:this.getCloseAction(t.data),error:this.getCloseError(t.data)};throw"Invalid handshake"}},getCloseAction:function(e){return e.code<4e3?e.code>=1002&&e.code<=1004?"backoff":null:e.code===4e3?"tls_only":e.code<4100?"refused":e.code<4200?"backoff":e.code<4300?"retry":"refused"},getCloseError:function(e){return e.code!==1e3&&e.code!==1001?{type:"PusherError",data:{code:e.code,message:e.reason||e.message}}:null}},pt=je,er=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),nr=function(e){er(t,e);function t(n,r){var i=e.call(this)||this;return i.id=n,i.transport=r,i.activityTimeout=r.activityTimeout,i.bindListeners(),i}return t.prototype.handlesActivityChecks=function(){return this.transport.handlesActivityChecks()},t.prototype.send=function(n){return this.transport.send(n)},t.prototype.send_event=function(n,r,i){var o={event:n,data:r};return i&&(o.channel=i),D.debug("Event sent",o),this.send(pt.encodeMessage(o))},t.prototype.ping=function(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})},t.prototype.close=function(){this.transport.close()},t.prototype.bindListeners=function(){var n=this,r={message:function(o){var f;try{f=pt.decodeMessage(o)}catch(v){n.emit("error",{type:"MessageParseError",error:v,data:o.data})}if(f!==void 0){switch(D.debug("Event recd",f),f.event){case"pusher:error":n.emit("error",{type:"PusherError",data:f.data});break;case"pusher:ping":n.emit("ping");break;case"pusher:pong":n.emit("pong");break}n.emit("message",f)}},activity:function(){n.emit("activity")},error:function(o){n.emit("error",o)},closed:function(o){i(),o&&o.code&&n.handleCloseEvent(o),n.transport=null,n.emit("closed")}},i=function(){ot(r,function(o,f){n.transport.unbind(f,o)})};ot(r,function(o,f){n.transport.bind(f,o)})},t.prototype.handleCloseEvent=function(n){var r=pt.getCloseAction(n),i=pt.getCloseError(n);i&&this.emit("error",i),r&&this.emit(r,{action:r,error:i})},t}(st),rr=nr,ir=function(){function e(t,n){this.transport=t,this.callback=n,this.bindListeners()}return e.prototype.close=function(){this.unbindListeners(),this.transport.close()},e.prototype.bindListeners=function(){var t=this;this.onMessage=function(n){t.unbindListeners();var r;try{r=pt.processHandshake(n)}catch(i){t.finish("error",{error:i}),t.transport.close();return}r.action==="connected"?t.finish("connected",{connection:new rr(r.id,t.transport),activityTimeout:r.activityTimeout}):(t.finish(r.action,{error:r.error}),t.transport.close())},this.onClosed=function(n){t.unbindListeners();var r=pt.getCloseAction(n)||"backoff",i=pt.getCloseError(n);t.finish(r,{error:i})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)},e.prototype.unbindListeners=function(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)},e.prototype.finish=function(t,n){this.callback(G({transport:this.transport,action:t},n))},e}(),or=ir,sr=function(){function e(t,n){this.timeline=t,this.options=n||{}}return e.prototype.send=function(t,n){this.timeline.isEmpty()||this.timeline.send(A.TimelineTransport.getAgent(this,t),n)},e}(),ar=sr,ur=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),cr=function(e){ur(t,e);function t(n,r){var i=e.call(this,function(o,f){D.debug("No callbacks on "+n+" for "+o)})||this;return i.name=n,i.pusher=r,i.subscribed=!1,i.subscriptionPending=!1,i.subscriptionCancelled=!1,i}return t.prototype.authorize=function(n,r){return r(null,{auth:""})},t.prototype.trigger=function(n,r){if(n.indexOf("client-")!==0)throw new x("Event '"+n+"' does not start with 'client-'");if(!this.subscribed){var i=g.buildLogSuffix("triggeringClientEvents");D.warn("Client event triggered before channel 'subscription_succeeded' event . "+i)}return this.pusher.send_event(n,r,this.name)},t.prototype.disconnect=function(){this.subscribed=!1,this.subscriptionPending=!1},t.prototype.handleEvent=function(n){var r=n.event,i=n.data;if(r==="pusher_internal:subscription_succeeded")this.handleSubscriptionSucceededEvent(n);else if(r==="pusher_internal:subscription_count")this.handleSubscriptionCountEvent(n);else if(r.indexOf("pusher_internal:")!==0){var o={};this.emit(r,i,o)}},t.prototype.handleSubscriptionSucceededEvent=function(n){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",n.data)},t.prototype.handleSubscriptionCountEvent=function(n){n.data.subscription_count&&(this.subscriptionCount=n.data.subscription_count),this.emit("pusher:subscription_count",n.data)},t.prototype.subscribe=function(){var n=this;this.subscribed||(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,function(r,i){r?(n.subscriptionPending=!1,D.error(r.toString()),n.emit("pusher:subscription_error",Object.assign({},{type:"AuthError",error:r.message},r instanceof K?{status:r.status}:{}))):n.pusher.send_event("pusher:subscribe",{auth:i.auth,channel_data:i.channel_data,channel:n.name})}))},t.prototype.unsubscribe=function(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})},t.prototype.cancelSubscription=function(){this.subscriptionCancelled=!0},t.prototype.reinstateSubscription=function(){this.subscriptionCancelled=!1},t}(st),te=cr,lr=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),hr=function(e){lr(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.authorize=function(n,r){return this.pusher.config.channelAuthorizer({channelName:this.name,socketId:n},r)},t}(te),ee=hr,fr=function(){function e(){this.reset()}return e.prototype.get=function(t){return Object.prototype.hasOwnProperty.call(this.members,t)?{id:t,info:this.members[t]}:null},e.prototype.each=function(t){var n=this;ot(this.members,function(r,i){t(n.get(i))})},e.prototype.setMyID=function(t){this.myID=t},e.prototype.onSubscription=function(t){this.members=t.presence.hash,this.count=t.presence.count,this.me=this.get(this.myID)},e.prototype.addMember=function(t){return this.get(t.user_id)===null&&this.count++,this.members[t.user_id]=t.user_info,this.get(t.user_id)},e.prototype.removeMember=function(t){var n=this.get(t.user_id);return n&&(delete this.members[t.user_id],this.count--),n},e.prototype.reset=function(){this.members={},this.count=0,this.myID=null,this.me=null},e}(),pr=fr,dr=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),vr=function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(f){f(o)})}return new(n||(n=Promise))(function(o,f){function v(I){try{_(r.next(I))}catch(B){f(B)}}function S(I){try{_(r.throw(I))}catch(B){f(B)}}function _(I){I.done?o(I.value):i(I.value).then(v,S)}_((r=r.apply(e,t||[])).next())})},yr=function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,f;return f={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function v(_){return function(I){return S([_,I])}}function S(_){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(o=_[0]&2?i.return:_[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,_[1])).done)return o;switch(i=0,o&&(_=[_[0]&2,o.value]),_[0]){case 0:case 1:o=_;break;case 4:return n.label++,{value:_[1],done:!1};case 5:n.label++,i=_[1],_=[0];continue;case 7:_=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(_[0]===6||_[0]===2)){n=0;continue}if(_[0]===3&&(!o||_[1]>o[0]&&_[1]<o[3])){n.label=_[1];break}if(_[0]===6&&n.label<o[1]){n.label=o[1],o=_;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(_);break}o[2]&&n.ops.pop(),n.trys.pop();continue}_=t.call(e,n)}catch(I){_=[6,I],i=0}finally{r=o=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},gr=function(e){dr(t,e);function t(n,r){var i=e.call(this,n,r)||this;return i.members=new pr,i}return t.prototype.authorize=function(n,r){var i=this;e.prototype.authorize.call(this,n,function(o,f){return vr(i,void 0,void 0,function(){var v,S;return yr(this,function(_){switch(_.label){case 0:return o?[3,3]:(f=f,f.channel_data==null?[3,1]:(v=JSON.parse(f.channel_data),this.members.setMyID(v.user_id),[3,3]));case 1:return[4,this.pusher.user.signinDonePromise];case 2:if(_.sent(),this.pusher.user.user_data!=null)this.members.setMyID(this.pusher.user.user_data.id);else return S=g.buildLogSuffix("authorizationEndpoint"),D.error("Invalid auth response for channel '"+this.name+"', "+("expected 'channel_data' field. "+S+", ")+"or the user should be signed in."),r("Invalid auth response"),[2];_.label=3;case 3:return r(o,f),[2]}})})})},t.prototype.handleEvent=function(n){var r=n.event;if(r.indexOf("pusher_internal:")===0)this.handleInternalEvent(n);else{var i=n.data,o={};n.user_id&&(o.user_id=n.user_id),this.emit(r,i,o)}},t.prototype.handleInternalEvent=function(n){var r=n.event,i=n.data;switch(r){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(n);break;case"pusher_internal:subscription_count":this.handleSubscriptionCountEvent(n);break;case"pusher_internal:member_added":var o=this.members.addMember(i);this.emit("pusher:member_added",o);break;case"pusher_internal:member_removed":var f=this.members.removeMember(i);f&&this.emit("pusher:member_removed",f);break}},t.prototype.handleSubscriptionSucceededEvent=function(n){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(n.data),this.emit("pusher:subscription_succeeded",this.members))},t.prototype.disconnect=function(){this.members.reset(),e.prototype.disconnect.call(this)},t}(ee),_r=gr,mr=s(1),ne=s(0),br=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),wr=function(e){br(t,e);function t(n,r,i){var o=e.call(this,n,r)||this;return o.key=null,o.nacl=i,o}return t.prototype.authorize=function(n,r){var i=this;e.prototype.authorize.call(this,n,function(o,f){if(o){r(o,f);return}var v=f.shared_secret;if(!v){r(new Error("No shared_secret key in auth payload for encrypted channel: "+i.name),null);return}i.key=Object(ne.decode)(v),delete f.shared_secret,r(null,f)})},t.prototype.trigger=function(n,r){throw new q("Client events are not currently supported for encrypted channels")},t.prototype.handleEvent=function(n){var r=n.event,i=n.data;if(r.indexOf("pusher_internal:")===0||r.indexOf("pusher:")===0){e.prototype.handleEvent.call(this,n);return}this.handleEncryptedEvent(r,i)},t.prototype.handleEncryptedEvent=function(n,r){var i=this;if(!this.key){D.debug("Received encrypted event before key has been retrieved from the authEndpoint");return}if(!r.ciphertext||!r.nonce){D.error("Unexpected format for encrypted event, expected object with `ciphertext` and `nonce` fields, got: "+r);return}var o=Object(ne.decode)(r.ciphertext);if(o.length<this.nacl.secretbox.overheadLength){D.error("Expected encrypted event ciphertext length to be "+this.nacl.secretbox.overheadLength+", got: "+o.length);return}var f=Object(ne.decode)(r.nonce);if(f.length<this.nacl.secretbox.nonceLength){D.error("Expected encrypted event nonce length to be "+this.nacl.secretbox.nonceLength+", got: "+f.length);return}var v=this.nacl.secretbox.open(o,f,this.key);if(v===null){D.debug("Failed to decrypt an event, probably because it was encrypted with a different key. Fetching a new key from the authEndpoint..."),this.authorize(this.pusher.connection.socket_id,function(S,_){if(S){D.error("Failed to make a request to the authEndpoint: "+_+". Unable to fetch new key, so dropping encrypted event");return}if(v=i.nacl.secretbox.open(o,f,i.key),v===null){D.error("Failed to decrypt event with new key. Dropping encrypted event");return}i.emit(n,i.getDataToEmit(v))});return}this.emit(n,this.getDataToEmit(v))},t.prototype.getDataToEmit=function(n){var r=Object(mr.decode)(n);try{return JSON.parse(r)}catch{return r}},t}(ee),Cr=wr,Sr=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),kr=function(e){Sr(t,e);function t(n,r){var i=e.call(this)||this;i.state="initialized",i.connection=null,i.key=n,i.options=r,i.timeline=i.options.timeline,i.usingTLS=i.options.useTLS,i.errorCallbacks=i.buildErrorCallbacks(),i.connectionCallbacks=i.buildConnectionCallbacks(i.errorCallbacks),i.handshakeCallbacks=i.buildHandshakeCallbacks(i.errorCallbacks);var o=A.getNetwork();return o.bind("online",function(){i.timeline.info({netinfo:"online"}),(i.state==="connecting"||i.state==="unavailable")&&i.retryIn(0)}),o.bind("offline",function(){i.timeline.info({netinfo:"offline"}),i.connection&&i.sendActivityCheck()}),i.updateStrategy(),i}return t.prototype.connect=function(){if(!(this.connection||this.runner)){if(!this.strategy.isSupported()){this.updateState("failed");return}this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()}},t.prototype.send=function(n){return this.connection?this.connection.send(n):!1},t.prototype.send_event=function(n,r,i){return this.connection?this.connection.send_event(n,r,i):!1},t.prototype.disconnect=function(){this.disconnectInternally(),this.updateState("disconnected")},t.prototype.isUsingTLS=function(){return this.usingTLS},t.prototype.startConnecting=function(){var n=this,r=function(i,o){i?n.runner=n.strategy.connect(0,r):o.action==="error"?(n.emit("error",{type:"HandshakeError",error:o.error}),n.timeline.error({handshakeError:o.error})):(n.abortConnecting(),n.handshakeCallbacks[o.action](o))};this.runner=this.strategy.connect(0,r)},t.prototype.abortConnecting=function(){this.runner&&(this.runner.abort(),this.runner=null)},t.prototype.disconnectInternally=function(){if(this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection){var n=this.abandonConnection();n.close()}},t.prototype.updateStrategy=function(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})},t.prototype.retryIn=function(n){var r=this;this.timeline.info({action:"retry",delay:n}),n>0&&this.emit("connecting_in",Math.round(n/1e3)),this.retryTimer=new ht(n||0,function(){r.disconnectInternally(),r.connect()})},t.prototype.clearRetryTimer=function(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)},t.prototype.setUnavailableTimer=function(){var n=this;this.unavailableTimer=new ht(this.options.unavailableTimeout,function(){n.updateState("unavailable")})},t.prototype.clearUnavailableTimer=function(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()},t.prototype.sendActivityCheck=function(){var n=this;this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new ht(this.options.pongTimeout,function(){n.timeline.error({pong_timed_out:n.options.pongTimeout}),n.retryIn(0)})},t.prototype.resetActivityCheck=function(){var n=this;this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new ht(this.activityTimeout,function(){n.sendActivityCheck()}))},t.prototype.stopActivityCheck=function(){this.activityTimer&&this.activityTimer.ensureAborted()},t.prototype.buildConnectionCallbacks=function(n){var r=this;return G({},n,{message:function(i){r.resetActivityCheck(),r.emit("message",i)},ping:function(){r.send_event("pusher:pong",{})},activity:function(){r.resetActivityCheck()},error:function(i){r.emit("error",i)},closed:function(){r.abandonConnection(),r.shouldRetry()&&r.retryIn(1e3)}})},t.prototype.buildHandshakeCallbacks=function(n){var r=this;return G({},n,{connected:function(i){r.activityTimeout=Math.min(r.options.activityTimeout,i.activityTimeout,i.connection.activityTimeout||1/0),r.clearUnavailableTimer(),r.setConnection(i.connection),r.socket_id=r.connection.id,r.updateState("connected",{socket_id:r.socket_id})}})},t.prototype.buildErrorCallbacks=function(){var n=this,r=function(i){return function(o){o.error&&n.emit("error",{type:"WebSocketError",error:o.error}),i(o)}};return{tls_only:r(function(){n.usingTLS=!0,n.updateStrategy(),n.retryIn(0)}),refused:r(function(){n.disconnect()}),backoff:r(function(){n.retryIn(1e3)}),retry:r(function(){n.retryIn(0)})}},t.prototype.setConnection=function(n){this.connection=n;for(var r in this.connectionCallbacks)this.connection.bind(r,this.connectionCallbacks[r]);this.resetActivityCheck()},t.prototype.abandonConnection=function(){if(!!this.connection){this.stopActivityCheck();for(var n in this.connectionCallbacks)this.connection.unbind(n,this.connectionCallbacks[n]);var r=this.connection;return this.connection=null,r}},t.prototype.updateState=function(n,r){var i=this.state;if(this.state=n,i!==n){var o=n;o==="connected"&&(o+=" with new socket ID "+r.socket_id),D.debug("State changed",i+" -> "+o),this.timeline.info({state:n,params:r}),this.emit("state_change",{previous:i,current:n}),this.emit(n,r)}},t.prototype.shouldRetry=function(){return this.state==="connecting"||this.state==="connected"},t}(st),Tr=kr,xr=function(){function e(){this.channels={}}return e.prototype.add=function(t,n){return this.channels[t]||(this.channels[t]=Or(t,n)),this.channels[t]},e.prototype.all=function(){return vn(this.channels)},e.prototype.find=function(t){return this.channels[t]},e.prototype.remove=function(t){var n=this.channels[t];return delete this.channels[t],n},e.prototype.disconnect=function(){ot(this.channels,function(t){t.disconnect()})},e}(),Pr=xr;function Or(e,t){if(e.indexOf("private-encrypted-")===0){if(t.config.nacl)return at.createEncryptedChannel(e,t,t.config.nacl);var n="Tried to subscribe to a private-encrypted- channel but no nacl implementation available",r=g.buildLogSuffix("encryptedChannelSupport");throw new q(n+". "+r)}else{if(e.indexOf("private-")===0)return at.createPrivateChannel(e,t);if(e.indexOf("presence-")===0)return at.createPresenceChannel(e,t);if(e.indexOf("#")===0)throw new R('Cannot create a channel with name "'+e+'".');return at.createChannel(e,t)}}var Er={createChannels:function(){return new Pr},createConnectionManager:function(e,t){return new Tr(e,t)},createChannel:function(e,t){return new te(e,t)},createPrivateChannel:function(e,t){return new ee(e,t)},createPresenceChannel:function(e,t){return new _r(e,t)},createEncryptedChannel:function(e,t,n){return new Cr(e,t,n)},createTimelineSender:function(e,t){return new ar(e,t)},createHandshake:function(e,t){return new or(e,t)},createAssistantToTheTransportManager:function(e,t,n){return new tr(e,t,n)}},at=Er,Ar=function(){function e(t){this.options=t||{},this.livesLeft=this.options.lives||1/0}return e.prototype.getAssistant=function(t){return at.createAssistantToTheTransportManager(this,t,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})},e.prototype.isAlive=function(){return this.livesLeft>0},e.prototype.reportDeath=function(){this.livesLeft-=1},e}(),Ne=Ar,Lr=function(){function e(t,n){this.strategies=t,this.loop=Boolean(n.loop),this.failFast=Boolean(n.failFast),this.timeout=n.timeout,this.timeoutLimit=n.timeoutLimit}return e.prototype.isSupported=function(){return Oe(this.strategies,J.method("isSupported"))},e.prototype.connect=function(t,n){var r=this,i=this.strategies,o=0,f=this.timeout,v=null,S=function(_,I){I?n(null,I):(o=o+1,r.loop&&(o=o%i.length),o<i.length?(f&&(f=f*2,r.timeoutLimit&&(f=Math.min(f,r.timeoutLimit))),v=r.tryStrategy(i[o],t,{timeout:f,failFast:r.failFast},S)):n(!0))};return v=this.tryStrategy(i[o],t,{timeout:f,failFast:this.failFast},S),{abort:function(){v.abort()},forceMinPriority:function(_){t=_,v&&v.forceMinPriority(_)}}},e.prototype.tryStrategy=function(t,n,r,i){var o=null,f=null;return r.timeout>0&&(o=new ht(r.timeout,function(){f.abort(),i(!0)})),f=t.connect(n,function(v,S){v&&o&&o.isRunning()&&!r.failFast||(o&&o.ensureAborted(),i(v,S))}),{abort:function(){o&&o.ensureAborted(),f.abort()},forceMinPriority:function(v){f.forceMinPriority(v)}}},e}(),dt=Lr,Ir=function(){function e(t){this.strategies=t}return e.prototype.isSupported=function(){return Oe(this.strategies,J.method("isSupported"))},e.prototype.connect=function(t,n){return Rr(this.strategies,t,function(r,i){return function(o,f){if(i[r].error=o,o){jr(i)&&n(!0);return}Pt(i,function(v){v.forceMinPriority(f.transport.priority)}),n(null,f)}})},e}(),re=Ir;function Rr(e,t,n){var r=Te(e,function(i,o,f,v){return i.connect(t,n(o,v))});return{abort:function(){Pt(r,Nr)},forceMinPriority:function(i){Pt(r,function(o){o.forceMinPriority(i)})}}}function jr(e){return _n(e,function(t){return Boolean(t.error)})}function Nr(e){!e.error&&!e.aborted&&(e.abort(),e.aborted=!0)}var Dr=function(){function e(t,n,r){this.strategy=t,this.transports=n,this.ttl=r.ttl||1800*1e3,this.usingTLS=r.useTLS,this.timeline=r.timeline}return e.prototype.isSupported=function(){return this.strategy.isSupported()},e.prototype.connect=function(t,n){var r=this.usingTLS,i=Ur(r),o=[this.strategy];if(i&&i.timestamp+this.ttl>=J.now()){var f=this.transports[i.transport];f&&(this.timeline.info({cached:!0,transport:i.transport,latency:i.latency}),o.push(new dt([f],{timeout:i.latency*2+1e3,failFast:!0})))}var v=J.now(),S=o.pop().connect(t,function _(I,B){I?(De(r),o.length>0?(v=J.now(),S=o.pop().connect(t,_)):n(I)):(qr(r,B.transport.name,J.now()-v),n(null,B))});return{abort:function(){S.abort()},forceMinPriority:function(_){t=_,S&&S.forceMinPriority(_)}}},e}(),Mr=Dr;function ie(e){return"pusherTransport"+(e?"TLS":"NonTLS")}function Ur(e){var t=A.getLocalStorage();if(t)try{var n=t[ie(e)];if(n)return JSON.parse(n)}catch{De(e)}return null}function qr(e,t,n){var r=A.getLocalStorage();if(r)try{r[ie(e)]=Nt({timestamp:J.now(),transport:t,latency:n})}catch{}}function De(e){var t=A.getLocalStorage();if(t)try{delete t[ie(e)]}catch{}}var Br=function(){function e(t,n){var r=n.delay;this.strategy=t,this.options={delay:r}}return e.prototype.isSupported=function(){return this.strategy.isSupported()},e.prototype.connect=function(t,n){var r=this.strategy,i,o=new ht(this.options.delay,function(){i=r.connect(t,n)});return{abort:function(){o.ensureAborted(),i&&i.abort()},forceMinPriority:function(f){t=f,i&&i.forceMinPriority(f)}}},e}(),Mt=Br,Hr=function(){function e(t,n,r){this.test=t,this.trueBranch=n,this.falseBranch=r}return e.prototype.isSupported=function(){var t=this.test()?this.trueBranch:this.falseBranch;return t.isSupported()},e.prototype.connect=function(t,n){var r=this.test()?this.trueBranch:this.falseBranch;return r.connect(t,n)},e}(),Ot=Hr,zr=function(){function e(t){this.strategy=t}return e.prototype.isSupported=function(){return this.strategy.isSupported()},e.prototype.connect=function(t,n){var r=this.strategy.connect(t,function(i,o){o&&r.abort(),n(i,o)});return r},e}(),Fr=zr;function Et(e){return function(){return e.isSupported()}}var $r=function(e,t,n){var r={};function i(Ve,Zi,to,eo,no){var Ge=n(e,Ve,Zi,to,eo,no);return r[Ve]=Ge,Ge}var o=Object.assign({},t,{hostNonTLS:e.wsHost+":"+e.wsPort,hostTLS:e.wsHost+":"+e.wssPort,httpPath:e.wsPath}),f=Object.assign({},o,{useTLS:!0}),v=Object.assign({},t,{hostNonTLS:e.httpHost+":"+e.httpPort,hostTLS:e.httpHost+":"+e.httpsPort,httpPath:e.httpPath}),S={loop:!0,timeout:15e3,timeoutLimit:6e4},_=new Ne({lives:2,minPingDelay:1e4,maxPingDelay:e.activityTimeout}),I=new Ne({lives:2,minPingDelay:1e4,maxPingDelay:e.activityTimeout}),B=i("ws","ws",3,o,_),rt=i("wss","ws",3,f,_),Vi=i("sockjs","sockjs",1,v),ze=i("xhr_streaming","xhr_streaming",1,v,I),Gi=i("xdr_streaming","xdr_streaming",1,v,I),Fe=i("xhr_polling","xhr_polling",1,v),Qi=i("xdr_polling","xdr_polling",1,v),$e=new dt([B],S),Ki=new dt([rt],S),Yi=new dt([Vi],S),Xe=new dt([new Ot(Et(ze),ze,Gi)],S),Je=new dt([new Ot(Et(Fe),Fe,Qi)],S),We=new dt([new Ot(Et(Xe),new re([Xe,new Mt(Je,{delay:4e3})]),Je)],S),ue=new Ot(Et(We),We,Yi),ce;return t.useTLS?ce=new re([$e,new Mt(ue,{delay:2e3})]):ce=new re([$e,new Mt(Ki,{delay:2e3}),new Mt(ue,{delay:5e3})]),new Mr(new Fr(new Ot(Et(B),ce,ue)),r,{ttl:18e5,timeline:t.timeline,useTLS:t.useTLS})},Xr=$r,Jr=function(){var e=this;e.timeline.info(e.buildTimelineMessage({transport:e.name+(e.options.useTLS?"s":"")})),e.hooks.isInitialized()?e.changeState("initialized"):e.hooks.file?(e.changeState("initializing"),b.load(e.hooks.file,{useTLS:e.options.useTLS},function(t,n){e.hooks.isInitialized()?(e.changeState("initialized"),n(!0)):(t&&e.onError(t),e.onClose(),n(!1))})):e.onClose()},Wr={getRequest:function(e){var t=new window.XDomainRequest;return t.ontimeout=function(){e.emit("error",new E),e.close()},t.onerror=function(n){e.emit("error",n),e.close()},t.onprogress=function(){t.responseText&&t.responseText.length>0&&e.onChunk(200,t.responseText)},t.onload=function(){t.responseText&&t.responseText.length>0&&e.onChunk(200,t.responseText),e.emit("finished",200),e.close()},t},abortRequest:function(e){e.ontimeout=e.onerror=e.onprogress=e.onload=null,e.abort()}},Vr=Wr,Gr=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qr=256*1024,Kr=function(e){Gr(t,e);function t(n,r,i){var o=e.call(this)||this;return o.hooks=n,o.method=r,o.url=i,o}return t.prototype.start=function(n){var r=this;this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=function(){r.close()},A.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(n)},t.prototype.close=function(){this.unloader&&(A.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)},t.prototype.onChunk=function(n,r){for(;;){var i=this.advanceBuffer(r);if(i)this.emit("chunk",{status:n,data:i});else break}this.isBufferTooLong(r)&&this.emit("buffer_too_long")},t.prototype.advanceBuffer=function(n){var r=n.slice(this.position),i=r.indexOf(`
`);return i!==-1?(this.position+=i+1,r.slice(0,i)):null},t.prototype.isBufferTooLong=function(n){return this.position===n.length&&n.length>Qr},t}(st),Yr=Kr,oe;(function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSED=3]="CLOSED"})(oe||(oe={}));var vt=oe,Zr=1,ti=function(){function e(t,n){this.hooks=t,this.session=Ue(1e3)+"/"+ii(8),this.location=ei(n),this.readyState=vt.CONNECTING,this.openStream()}return e.prototype.send=function(t){return this.sendRaw(JSON.stringify([t]))},e.prototype.ping=function(){this.hooks.sendHeartbeat(this)},e.prototype.close=function(t,n){this.onClose(t,n,!0)},e.prototype.sendRaw=function(t){if(this.readyState===vt.OPEN)try{return A.createSocketRequest("POST",Me(ni(this.location,this.session))).start(t),!0}catch{return!1}else return!1},e.prototype.reconnect=function(){this.closeStream(),this.openStream()},e.prototype.onClose=function(t,n,r){this.closeStream(),this.readyState=vt.CLOSED,this.onclose&&this.onclose({code:t,reason:n,wasClean:r})},e.prototype.onChunk=function(t){if(t.status===200){this.readyState===vt.OPEN&&this.onActivity();var n,r=t.data.slice(0,1);switch(r){case"o":n=JSON.parse(t.data.slice(1)||"{}"),this.onOpen(n);break;case"a":n=JSON.parse(t.data.slice(1)||"[]");for(var i=0;i<n.length;i++)this.onEvent(n[i]);break;case"m":n=JSON.parse(t.data.slice(1)||"null"),this.onEvent(n);break;case"h":this.hooks.onHeartbeat(this);break;case"c":n=JSON.parse(t.data.slice(1)||"[]"),this.onClose(n[0],n[1],!0);break}}},e.prototype.onOpen=function(t){this.readyState===vt.CONNECTING?(t&&t.hostname&&(this.location.base=ri(this.location.base,t.hostname)),this.readyState=vt.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)},e.prototype.onEvent=function(t){this.readyState===vt.OPEN&&this.onmessage&&this.onmessage({data:t})},e.prototype.onActivity=function(){this.onactivity&&this.onactivity()},e.prototype.onError=function(t){this.onerror&&this.onerror(t)},e.prototype.openStream=function(){var t=this;this.stream=A.createSocketRequest("POST",Me(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",function(n){t.onChunk(n)}),this.stream.bind("finished",function(n){t.hooks.onFinished(t,n)}),this.stream.bind("buffer_too_long",function(){t.reconnect()});try{this.stream.start()}catch(n){J.defer(function(){t.onError(n),t.onClose(1006,"Could not start streaming",!1)})}},e.prototype.closeStream=function(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)},e}();function ei(e){var t=/([^\?]*)\/*(\??.*)/.exec(e);return{base:t[1],queryString:t[2]}}function ni(e,t){return e.base+"/"+t+"/xhr_send"}function Me(e){var t=e.indexOf("?")===-1?"?":"&";return e+t+"t="+ +new Date+"&n="+Zr++}function ri(e,t){var n=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(e);return n[1]+t+n[3]}function Ue(e){return A.randomInt(e)}function ii(e){for(var t=[],n=0;n<e;n++)t.push(Ue(32).toString(32));return t.join("")}var oi=ti,si={getReceiveURL:function(e,t){return e.base+"/"+t+"/xhr_streaming"+e.queryString},onHeartbeat:function(e){e.sendRaw("[]")},sendHeartbeat:function(e){e.sendRaw("[]")},onFinished:function(e,t){e.onClose(1006,"Connection interrupted ("+t+")",!1)}},ai=si,ui={getReceiveURL:function(e,t){return e.base+"/"+t+"/xhr"+e.queryString},onHeartbeat:function(){},sendHeartbeat:function(e){e.sendRaw("[]")},onFinished:function(e,t){t===200?e.reconnect():e.onClose(1006,"Connection interrupted ("+t+")",!1)}},ci=ui,li={getRequest:function(e){var t=A.getXHRAPI(),n=new t;return n.onreadystatechange=n.onprogress=function(){switch(n.readyState){case 3:n.responseText&&n.responseText.length>0&&e.onChunk(n.status,n.responseText);break;case 4:n.responseText&&n.responseText.length>0&&e.onChunk(n.status,n.responseText),e.emit("finished",n.status),e.close();break}},n},abortRequest:function(e){e.onreadystatechange=null,e.abort()}},hi=li,fi={createStreamingSocket:function(e){return this.createSocket(ai,e)},createPollingSocket:function(e){return this.createSocket(ci,e)},createSocket:function(e,t){return new oi(e,t)},createXHR:function(e,t){return this.createRequest(hi,e,t)},createRequest:function(e,t,n){return new Yr(e,t,n)}},qe=fi;qe.createXDR=function(e,t){return this.createRequest(Vr,e,t)};var pi=qe,di={nextAuthCallbackID:1,auth_callbacks:{},ScriptReceivers:h,DependenciesReceivers:k,getDefaultStrategy:Xr,Transports:Gn,transportConnectionInitializer:Jr,HTTPFactory:pi,TimelineTransport:Ln,getXHRAPI:function(){return window.XMLHttpRequest},getWebSocketAPI:function(){return window.WebSocket||window.MozWebSocket},setup:function(e){var t=this;window.Pusher=e;var n=function(){t.onDocumentBody(e.ready)};window.JSON?n():b.load("json2",{},n)},getDocument:function(){return document},getProtocol:function(){return this.getDocument().location.protocol},getAuthorizers:function(){return{ajax:it,jsonp:kn}},onDocumentBody:function(e){var t=this;document.body?e():setTimeout(function(){t.onDocumentBody(e)},0)},createJSONPRequest:function(e,t){return new On(e,t)},createScriptRequest:function(e){return new xn(e)},getLocalStorage:function(){try{return window.localStorage}catch{return}},createXHR:function(){return this.getXHRAPI()?this.createXMLHttpRequest():this.createMicrosoftXHR()},createXMLHttpRequest:function(){var e=this.getXHRAPI();return new e},createMicrosoftXHR:function(){return new ActiveXObject("Microsoft.XMLHTTP")},getNetwork:function(){return Yn},createWebSocket:function(e){var t=this.getWebSocketAPI();return new t(e)},createSocketRequest:function(e,t){if(this.isXHRSupported())return this.HTTPFactory.createXHR(e,t);if(this.isXDRSupported(t.indexOf("https:")===0))return this.HTTPFactory.createXDR(e,t);throw"Cross-origin HTTP requests are not supported"},isXHRSupported:function(){var e=this.getXHRAPI();return Boolean(e)&&new e().withCredentials!==void 0},isXDRSupported:function(e){var t=e?"https:":"http:",n=this.getProtocol();return Boolean(window.XDomainRequest)&&n===t},addUnloadListener:function(e){window.addEventListener!==void 0?window.addEventListener("unload",e,!1):window.attachEvent!==void 0&&window.attachEvent("onunload",e)},removeUnloadListener:function(e){window.addEventListener!==void 0?window.removeEventListener("unload",e,!1):window.detachEvent!==void 0&&window.detachEvent("onunload",e)},randomInt:function(e){var t=function(){var n=window.crypto||window.msCrypto,r=n.getRandomValues(new Uint32Array(1))[0];return r/Math.pow(2,32)};return Math.floor(t()*e)}},A=di,se;(function(e){e[e.ERROR=3]="ERROR",e[e.INFO=6]="INFO",e[e.DEBUG=7]="DEBUG"})(se||(se={}));var Ut=se,vi=function(){function e(t,n,r){this.key=t,this.session=n,this.events=[],this.options=r||{},this.sent=0,this.uniqueID=0}return e.prototype.log=function(t,n){t<=this.options.level&&(this.events.push(G({},n,{timestamp:J.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())},e.prototype.error=function(t){this.log(Ut.ERROR,t)},e.prototype.info=function(t){this.log(Ut.INFO,t)},e.prototype.debug=function(t){this.log(Ut.DEBUG,t)},e.prototype.isEmpty=function(){return this.events.length===0},e.prototype.send=function(t,n){var r=this,i=G({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],t(i,function(o,f){o||r.sent++,n&&n(o,f)}),!0},e.prototype.generateUniqueID=function(){return this.uniqueID++,this.uniqueID},e}(),yi=vi,gi=function(){function e(t,n,r,i){this.name=t,this.priority=n,this.transport=r,this.options=i||{}}return e.prototype.isSupported=function(){return this.transport.isSupported({useTLS:this.options.useTLS})},e.prototype.connect=function(t,n){var r=this;if(this.isSupported()){if(this.priority<t)return Be(new N,n)}else return Be(new W,n);var i=!1,o=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),f=null,v=function(){o.unbind("initialized",v),o.connect()},S=function(){f=at.createHandshake(o,function(rt){i=!0,B(),n(null,rt)})},_=function(rt){B(),n(rt)},I=function(){B();var rt;rt=Nt(o),n(new j(rt))},B=function(){o.unbind("initialized",v),o.unbind("open",S),o.unbind("error",_),o.unbind("closed",I)};return o.bind("initialized",v),o.bind("open",S),o.bind("error",_),o.bind("closed",I),o.initialize(),{abort:function(){i||(B(),f?f.close():o.close())},forceMinPriority:function(rt){i||r.priority<rt&&(f?f.close():o.close())}}},e}(),_i=gi;function Be(e,t){return J.defer(function(){t(e)}),{abort:function(){},forceMinPriority:function(){}}}var mi=A.Transports,bi=function(e,t,n,r,i,o){var f=mi[n];if(!f)throw new U(n);var v=(!e.enabledTransports||Se(e.enabledTransports,t)!==-1)&&(!e.disabledTransports||Se(e.disabledTransports,t)===-1),S;return v?(i=Object.assign({ignoreNullOrigin:e.ignoreNullOrigin},i),S=new _i(t,r,o?o.getAssistant(f):f,i)):S=wi,S},wi={isSupported:function(){return!1},connect:function(e,t){var n=J.defer(function(){t(new W)});return{abort:function(){n.ensureAborted()},forceMinPriority:function(){}}}};function Ci(e){if(e==null)throw"You must pass an options object";if(e.cluster==null)throw"Options object must provide a cluster";"disableStats"in e&&D.warn("The disableStats option is deprecated in favor of enableStats")}var Si=function(e,t){var n="socket_id="+encodeURIComponent(e.socketId);for(var r in t.params)n+="&"+encodeURIComponent(r)+"="+encodeURIComponent(t.params[r]);if(t.paramsProvider!=null){var i=t.paramsProvider();for(var r in i)n+="&"+encodeURIComponent(r)+"="+encodeURIComponent(i[r])}return n},ki=function(e){if(typeof A.getAuthorizers()[e.transport]>"u")throw"'"+e.transport+"' is not a recognized auth transport";return function(t,n){var r=Si(t,e);A.getAuthorizers()[e.transport](A,r,e,d.UserAuthentication,n)}},Ti=ki,xi=function(e,t){var n="socket_id="+encodeURIComponent(e.socketId);n+="&channel_name="+encodeURIComponent(e.channelName);for(var r in t.params)n+="&"+encodeURIComponent(r)+"="+encodeURIComponent(t.params[r]);if(t.paramsProvider!=null){var i=t.paramsProvider();for(var r in i)n+="&"+encodeURIComponent(r)+"="+encodeURIComponent(i[r])}return n},Pi=function(e){if(typeof A.getAuthorizers()[e.transport]>"u")throw"'"+e.transport+"' is not a recognized auth transport";return function(t,n){var r=xi(t,e);A.getAuthorizers()[e.transport](A,r,e,d.ChannelAuthorization,n)}},Oi=Pi,Ei=function(e,t,n){var r={authTransport:t.transport,authEndpoint:t.endpoint,auth:{params:t.params,headers:t.headers}};return function(i,o){var f=e.channel(i.channelName),v=n(f,r);v.authorize(i.socketId,o)}},bt=function(){return bt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},bt.apply(this,arguments)};function Ai(e,t){var n={activityTimeout:e.activityTimeout||m.activityTimeout,cluster:e.cluster,httpPath:e.httpPath||m.httpPath,httpPort:e.httpPort||m.httpPort,httpsPort:e.httpsPort||m.httpsPort,pongTimeout:e.pongTimeout||m.pongTimeout,statsHost:e.statsHost||m.stats_host,unavailableTimeout:e.unavailableTimeout||m.unavailableTimeout,wsPath:e.wsPath||m.wsPath,wsPort:e.wsPort||m.wsPort,wssPort:e.wssPort||m.wssPort,enableStats:Ni(e),httpHost:Li(e),useTLS:ji(e),wsHost:Ii(e),userAuthenticator:Di(e),channelAuthorizer:Ui(e,t)};return"disabledTransports"in e&&(n.disabledTransports=e.disabledTransports),"enabledTransports"in e&&(n.enabledTransports=e.enabledTransports),"ignoreNullOrigin"in e&&(n.ignoreNullOrigin=e.ignoreNullOrigin),"timelineParams"in e&&(n.timelineParams=e.timelineParams),"nacl"in e&&(n.nacl=e.nacl),n}function Li(e){return e.httpHost?e.httpHost:e.cluster?"sockjs-"+e.cluster+".pusher.com":m.httpHost}function Ii(e){return e.wsHost?e.wsHost:Ri(e.cluster)}function Ri(e){return"ws-"+e+".pusher.com"}function ji(e){return A.getProtocol()==="https:"?!0:e.forceTLS!==!1}function Ni(e){return"enableStats"in e?e.enableStats:"disableStats"in e?!e.disableStats:!1}function Di(e){var t=bt(bt({},m.userAuthentication),e.userAuthentication);return"customHandler"in t&&t.customHandler!=null?t.customHandler:Ti(t)}function Mi(e,t){var n;return"channelAuthorization"in e?n=bt(bt({},m.channelAuthorization),e.channelAuthorization):(n={transport:e.authTransport||m.authTransport,endpoint:e.authEndpoint||m.authEndpoint},"auth"in e&&("params"in e.auth&&(n.params=e.auth.params),"headers"in e.auth&&(n.headers=e.auth.headers)),"authorizer"in e&&(n.customHandler=Ei(t,n,e.authorizer))),n}function Ui(e,t){var n=Mi(e,t);return"customHandler"in n&&n.customHandler!=null?n.customHandler:Oi(n)}var qi=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bi=function(e){qi(t,e);function t(n){var r=e.call(this,function(i,o){D.debug("No callbacks on watchlist events for "+i)})||this;return r.pusher=n,r.bindWatchlistInternalEvent(),r}return t.prototype.handleEvent=function(n){var r=this;n.data.events.forEach(function(i){r.emit(i.name,i)})},t.prototype.bindWatchlistInternalEvent=function(){var n=this;this.pusher.connection.bind("message",function(r){var i=r.event;i==="pusher_internal:watchlist_events"&&n.handleEvent(r)})},t}(st),Hi=Bi;function zi(){var e,t,n=new Promise(function(r,i){e=r,t=i});return{promise:n,resolve:e,reject:t}}var Fi=zi,$i=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xi=function(e){$i(t,e);function t(n){var r=e.call(this,function(i,o){D.debug("No callbacks on user for "+i)})||this;return r.signin_requested=!1,r.user_data=null,r.serverToUserChannel=null,r.signinDonePromise=null,r._signinDoneResolve=null,r._onAuthorize=function(i,o){if(i){D.warn("Error during signin: "+i),r._cleanup();return}r.pusher.send_event("pusher:signin",{auth:o.auth,user_data:o.user_data})},r.pusher=n,r.pusher.connection.bind("state_change",function(i){var o=i.previous,f=i.current;o!=="connected"&&f==="connected"&&r._signin(),o==="connected"&&f!=="connected"&&(r._cleanup(),r._newSigninPromiseIfNeeded())}),r.watchlist=new Hi(n),r.pusher.connection.bind("message",function(i){var o=i.event;o==="pusher:signin_success"&&r._onSigninSuccess(i.data),r.serverToUserChannel&&r.serverToUserChannel.name===i.channel&&r.serverToUserChannel.handleEvent(i)}),r}return t.prototype.signin=function(){this.signin_requested||(this.signin_requested=!0,this._signin())},t.prototype._signin=function(){!this.signin_requested||(this._newSigninPromiseIfNeeded(),this.pusher.connection.state==="connected"&&this.pusher.config.userAuthenticator({socketId:this.pusher.connection.socket_id},this._onAuthorize))},t.prototype._onSigninSuccess=function(n){try{this.user_data=JSON.parse(n.user_data)}catch{D.error("Failed parsing user data after signin: "+n.user_data),this._cleanup();return}if(typeof this.user_data.id!="string"||this.user_data.id===""){D.error("user_data doesn't contain an id. user_data: "+this.user_data),this._cleanup();return}this._signinDoneResolve(),this._subscribeChannels()},t.prototype._subscribeChannels=function(){var n=this,r=function(i){i.subscriptionPending&&i.subscriptionCancelled?i.reinstateSubscription():!i.subscriptionPending&&n.pusher.connection.state==="connected"&&i.subscribe()};this.serverToUserChannel=new te("#server-to-user-"+this.user_data.id,this.pusher),this.serverToUserChannel.bind_global(function(i,o){i.indexOf("pusher_internal:")===0||i.indexOf("pusher:")===0||n.emit(i,o)}),r(this.serverToUserChannel)},t.prototype._cleanup=function(){this.user_data=null,this.serverToUserChannel&&(this.serverToUserChannel.unbind_all(),this.serverToUserChannel.disconnect(),this.serverToUserChannel=null),this.signin_requested&&this._signinDoneResolve()},t.prototype._newSigninPromiseIfNeeded=function(){if(!!this.signin_requested&&!(this.signinDonePromise&&!this.signinDonePromise.done)){var n=Fi(),r=n.promise,i=n.resolve;r.done=!1;var o=function(){r.done=!0};r.then(o).catch(o),this.signinDonePromise=r,this._signinDoneResolve=i}},t}(st),Ji=Xi,He=function(){function e(t,n){var r=this;Wi(t),Ci(n),this.key=t,this.config=Ai(n,this),this.channels=at.createChannels(),this.global_emitter=new st,this.sessionID=A.randomInt(1e9),this.timeline=new yi(this.key,this.sessionID,{cluster:this.config.cluster,features:e.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:Ut.INFO,version:m.VERSION}),this.config.enableStats&&(this.timelineSender=at.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+A.TimelineTransport.name}));var i=function(o){return A.getDefaultStrategy(r.config,o,bi)};this.connection=at.createConnectionManager(this.key,{getStrategy:i,timeline:this.timeline,activityTimeout:this.config.activityTimeout,pongTimeout:this.config.pongTimeout,unavailableTimeout:this.config.unavailableTimeout,useTLS:Boolean(this.config.useTLS)}),this.connection.bind("connected",function(){r.subscribeAll(),r.timelineSender&&r.timelineSender.send(r.connection.isUsingTLS())}),this.connection.bind("message",function(o){var f=o.event,v=f.indexOf("pusher_internal:")===0;if(o.channel){var S=r.channel(o.channel);S&&S.handleEvent(o)}v||r.global_emitter.emit(o.event,o.data)}),this.connection.bind("connecting",function(){r.channels.disconnect()}),this.connection.bind("disconnected",function(){r.channels.disconnect()}),this.connection.bind("error",function(o){D.warn(o)}),e.instances.push(this),this.timeline.info({instances:e.instances.length}),this.user=new Ji(this),e.isReady&&this.connect()}return e.ready=function(){e.isReady=!0;for(var t=0,n=e.instances.length;t<n;t++)e.instances[t].connect()},e.getClientFeatures=function(){return ke(Pe({ws:A.Transports.ws},function(t){return t.isSupported({})}))},e.prototype.channel=function(t){return this.channels.find(t)},e.prototype.allChannels=function(){return this.channels.all()},e.prototype.connect=function(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var t=this.connection.isUsingTLS(),n=this.timelineSender;this.timelineSenderTimer=new fn(6e4,function(){n.send(t)})}},e.prototype.disconnect=function(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)},e.prototype.bind=function(t,n,r){return this.global_emitter.bind(t,n,r),this},e.prototype.unbind=function(t,n,r){return this.global_emitter.unbind(t,n,r),this},e.prototype.bind_global=function(t){return this.global_emitter.bind_global(t),this},e.prototype.unbind_global=function(t){return this.global_emitter.unbind_global(t),this},e.prototype.unbind_all=function(t){return this.global_emitter.unbind_all(),this},e.prototype.subscribeAll=function(){var t;for(t in this.channels.channels)this.channels.channels.hasOwnProperty(t)&&this.subscribe(t)},e.prototype.subscribe=function(t){var n=this.channels.add(t,this);return n.subscriptionPending&&n.subscriptionCancelled?n.reinstateSubscription():!n.subscriptionPending&&this.connection.state==="connected"&&n.subscribe(),n},e.prototype.unsubscribe=function(t){var n=this.channels.find(t);n&&n.subscriptionPending?n.cancelSubscription():(n=this.channels.remove(t),n&&n.subscribed&&n.unsubscribe())},e.prototype.send_event=function(t,n,r){return this.connection.send_event(t,n,r)},e.prototype.shouldUseTLS=function(){return this.config.useTLS},e.prototype.signin=function(){this.user.signin()},e.instances=[],e.isReady=!1,e.logToConsole=!1,e.Runtime=A,e.ScriptReceivers=A.ScriptReceivers,e.DependenciesReceivers=A.DependenciesReceivers,e.auth_callbacks=A.auth_callbacks,e}(),ae=a.default=He;function Wi(e){if(e==null)throw"You must pass your app key when you instantiate Pusher."}A.setup(He)}])})})(un);const us=po(un.exports);function ye(p){return ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},ye(p)}function $(p,c){if(!(p instanceof c))throw new TypeError("Cannot call a class as a function")}function Ze(p,c){for(var u=0;u<c.length;u++){var a=c[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(p,a.key,a)}}function X(p,c,u){return c&&Ze(p.prototype,c),u&&Ze(p,u),Object.defineProperty(p,"prototype",{writable:!1}),p}function ge(){return ge=Object.assign||function(p){for(var c=1;c<arguments.length;c++){var u=arguments[c];for(var a in u)Object.prototype.hasOwnProperty.call(u,a)&&(p[a]=u[a])}return p},ge.apply(this,arguments)}function tt(p,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function");p.prototype=Object.create(c&&c.prototype,{constructor:{value:p,writable:!0,configurable:!0}}),Object.defineProperty(p,"prototype",{writable:!1}),c&&_e(p,c)}function Xt(p){return Xt=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)},Xt(p)}function _e(p,c){return _e=Object.setPrototypeOf||function(a,s){return a.__proto__=s,a},_e(p,c)}function cs(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ls(p){if(p===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p}function hs(p,c){if(c&&(typeof c=="object"||typeof c=="function"))return c;if(c!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ls(p)}function et(p){var c=cs();return function(){var a=Xt(p),s;if(c){var l=Xt(this).constructor;s=Reflect.construct(a,arguments,l)}else s=a.apply(this,arguments);return hs(this,s)}}var we=function(){function p(){$(this,p)}return X(p,[{key:"listenForWhisper",value:function(u,a){return this.listen(".client-"+u,a)}},{key:"notification",value:function(u){return this.listen(".Illuminate\\Notifications\\Events\\BroadcastNotificationCreated",u)}},{key:"stopListeningForWhisper",value:function(u,a){return this.stopListening(".client-"+u,a)}}]),p}(),cn=function(){function p(c){$(this,p),this.setNamespace(c)}return X(p,[{key:"format",value:function(u){return u.charAt(0)==="."||u.charAt(0)==="\\"?u.substr(1):(this.namespace&&(u=this.namespace+"."+u),u.replace(/\./g,"\\"))}},{key:"setNamespace",value:function(u){this.namespace=u}}]),p}(),Wt=function(p){tt(u,p);var c=et(u);function u(a,s,l){var h;return $(this,u),h=c.call(this),h.name=s,h.pusher=a,h.options=l,h.eventFormatter=new cn(h.options.namespace),h.subscribe(),h}return X(u,[{key:"subscribe",value:function(){this.subscription=this.pusher.subscribe(this.name)}},{key:"unsubscribe",value:function(){this.pusher.unsubscribe(this.name)}},{key:"listen",value:function(s,l){return this.on(this.eventFormatter.format(s),l),this}},{key:"listenToAll",value:function(s){var l=this;return this.subscription.bind_global(function(h,C){if(!h.startsWith("pusher:")){var m=l.options.namespace.replace(/\./g,"\\"),L=h.startsWith(m)?h.substring(m.length+1):"."+h;s(L,C)}}),this}},{key:"stopListening",value:function(s,l){return l?this.subscription.unbind(this.eventFormatter.format(s),l):this.subscription.unbind(this.eventFormatter.format(s)),this}},{key:"stopListeningToAll",value:function(s){return s?this.subscription.unbind_global(s):this.subscription.unbind_global(),this}},{key:"subscribed",value:function(s){return this.on("pusher:subscription_succeeded",function(){s()}),this}},{key:"error",value:function(s){return this.on("pusher:subscription_error",function(l){s(l)}),this}},{key:"on",value:function(s,l){return this.subscription.bind(s,l),this}}]),u}(we),fs=function(p){tt(u,p);var c=et(u);function u(){return $(this,u),c.apply(this,arguments)}return X(u,[{key:"whisper",value:function(s,l){return this.pusher.channels.channels[this.name].trigger("client-".concat(s),l),this}}]),u}(Wt),ps=function(p){tt(u,p);var c=et(u);function u(){return $(this,u),c.apply(this,arguments)}return X(u,[{key:"whisper",value:function(s,l){return this.pusher.channels.channels[this.name].trigger("client-".concat(s),l),this}}]),u}(Wt),ds=function(p){tt(u,p);var c=et(u);function u(){return $(this,u),c.apply(this,arguments)}return X(u,[{key:"here",value:function(s){return this.on("pusher:subscription_succeeded",function(l){s(Object.keys(l.members).map(function(h){return l.members[h]}))}),this}},{key:"joining",value:function(s){return this.on("pusher:member_added",function(l){s(l.info)}),this}},{key:"leaving",value:function(s){return this.on("pusher:member_removed",function(l){s(l.info)}),this}},{key:"whisper",value:function(s,l){return this.pusher.channels.channels[this.name].trigger("client-".concat(s),l),this}}]),u}(Wt),ln=function(p){tt(u,p);var c=et(u);function u(a,s,l){var h;return $(this,u),h=c.call(this),h.events={},h.listeners={},h.name=s,h.socket=a,h.options=l,h.eventFormatter=new cn(h.options.namespace),h.subscribe(),h}return X(u,[{key:"subscribe",value:function(){this.socket.emit("subscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"unsubscribe",value:function(){this.unbind(),this.socket.emit("unsubscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"listen",value:function(s,l){return this.on(this.eventFormatter.format(s),l),this}},{key:"stopListening",value:function(s,l){return this.unbindEvent(this.eventFormatter.format(s),l),this}},{key:"subscribed",value:function(s){return this.on("connect",function(l){s(l)}),this}},{key:"error",value:function(s){return this}},{key:"on",value:function(s,l){var h=this;return this.listeners[s]=this.listeners[s]||[],this.events[s]||(this.events[s]=function(C,m){h.name===C&&h.listeners[s]&&h.listeners[s].forEach(function(L){return L(m)})},this.socket.on(s,this.events[s])),this.listeners[s].push(l),this}},{key:"unbind",value:function(){var s=this;Object.keys(this.events).forEach(function(l){s.unbindEvent(l)})}},{key:"unbindEvent",value:function(s,l){this.listeners[s]=this.listeners[s]||[],l&&(this.listeners[s]=this.listeners[s].filter(function(h){return h!==l})),(!l||this.listeners[s].length===0)&&(this.events[s]&&(this.socket.removeListener(s,this.events[s]),delete this.events[s]),delete this.listeners[s])}}]),u}(we),hn=function(p){tt(u,p);var c=et(u);function u(){return $(this,u),c.apply(this,arguments)}return X(u,[{key:"whisper",value:function(s,l){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(s),data:l}),this}}]),u}(ln),vs=function(p){tt(u,p);var c=et(u);function u(){return $(this,u),c.apply(this,arguments)}return X(u,[{key:"here",value:function(s){return this.on("presence:subscribed",function(l){s(l.map(function(h){return h.user_info}))}),this}},{key:"joining",value:function(s){return this.on("presence:joining",function(l){return s(l.user_info)}),this}},{key:"leaving",value:function(s){return this.on("presence:leaving",function(l){return s(l.user_info)}),this}}]),u}(hn),Jt=function(p){tt(u,p);var c=et(u);function u(){return $(this,u),c.apply(this,arguments)}return X(u,[{key:"subscribe",value:function(){}},{key:"unsubscribe",value:function(){}},{key:"listen",value:function(s,l){return this}},{key:"listenToAll",value:function(s){return this}},{key:"stopListening",value:function(s,l){return this}},{key:"subscribed",value:function(s){return this}},{key:"error",value:function(s){return this}},{key:"on",value:function(s,l){return this}}]),u}(we),tn=function(p){tt(u,p);var c=et(u);function u(){return $(this,u),c.apply(this,arguments)}return X(u,[{key:"whisper",value:function(s,l){return this}}]),u}(Jt),ys=function(p){tt(u,p);var c=et(u);function u(){return $(this,u),c.apply(this,arguments)}return X(u,[{key:"here",value:function(s){return this}},{key:"joining",value:function(s){return this}},{key:"leaving",value:function(s){return this}},{key:"whisper",value:function(s,l){return this}}]),u}(Jt),Ce=function(){function p(c){$(this,p),this._defaultOptions={auth:{headers:{}},authEndpoint:"/broadcasting/auth",userAuthentication:{endpoint:"/broadcasting/user-auth",headers:{}},broadcaster:"pusher",csrfToken:null,bearerToken:null,host:null,key:null,namespace:"App.Events"},this.setOptions(c),this.connect()}return X(p,[{key:"setOptions",value:function(u){this.options=ge(this._defaultOptions,u);var a=this.csrfToken();return a&&(this.options.auth.headers["X-CSRF-TOKEN"]=a,this.options.userAuthentication.headers["X-CSRF-TOKEN"]=a),a=this.options.bearerToken,a&&(this.options.auth.headers.Authorization="Bearer "+a,this.options.userAuthentication.headers.Authorization="Bearer "+a),u}},{key:"csrfToken",value:function(){var u;return typeof window<"u"&&window.Laravel&&window.Laravel.csrfToken?window.Laravel.csrfToken:this.options.csrfToken?this.options.csrfToken:typeof document<"u"&&typeof document.querySelector=="function"&&(u=document.querySelector('meta[name="csrf-token"]'))?u.getAttribute("content"):null}}]),p}(),gs=function(p){tt(u,p);var c=et(u);function u(){var a;return $(this,u),a=c.apply(this,arguments),a.channels={},a}return X(u,[{key:"connect",value:function(){typeof this.options.client<"u"?this.pusher=this.options.client:this.options.Pusher?this.pusher=new this.options.Pusher(this.options.key,this.options):this.pusher=new Pusher(this.options.key,this.options)}},{key:"signin",value:function(){this.pusher.signin()}},{key:"listen",value:function(s,l,h){return this.channel(s).listen(l,h)}},{key:"channel",value:function(s){return this.channels[s]||(this.channels[s]=new Wt(this.pusher,s,this.options)),this.channels[s]}},{key:"privateChannel",value:function(s){return this.channels["private-"+s]||(this.channels["private-"+s]=new fs(this.pusher,"private-"+s,this.options)),this.channels["private-"+s]}},{key:"encryptedPrivateChannel",value:function(s){return this.channels["private-encrypted-"+s]||(this.channels["private-encrypted-"+s]=new ps(this.pusher,"private-encrypted-"+s,this.options)),this.channels["private-encrypted-"+s]}},{key:"presenceChannel",value:function(s){return this.channels["presence-"+s]||(this.channels["presence-"+s]=new ds(this.pusher,"presence-"+s,this.options)),this.channels["presence-"+s]}},{key:"leave",value:function(s){var l=this,h=[s,"private-"+s,"private-encrypted-"+s,"presence-"+s];h.forEach(function(C,m){l.leaveChannel(C)})}},{key:"leaveChannel",value:function(s){this.channels[s]&&(this.channels[s].unsubscribe(),delete this.channels[s])}},{key:"socketId",value:function(){return this.pusher.connection.socket_id}},{key:"disconnect",value:function(){this.pusher.disconnect()}}]),u}(Ce),_s=function(p){tt(u,p);var c=et(u);function u(){var a;return $(this,u),a=c.apply(this,arguments),a.channels={},a}return X(u,[{key:"connect",value:function(){var s=this,l=this.getSocketIO();return this.socket=l(this.options.host,this.options),this.socket.on("reconnect",function(){Object.values(s.channels).forEach(function(h){h.subscribe()})}),this.socket}},{key:"getSocketIO",value:function(){if(typeof this.options.client<"u")return this.options.client;if(typeof io<"u")return io;throw new Error("Socket.io client not found. Should be globally available or passed via options.client")}},{key:"listen",value:function(s,l,h){return this.channel(s).listen(l,h)}},{key:"channel",value:function(s){return this.channels[s]||(this.channels[s]=new ln(this.socket,s,this.options)),this.channels[s]}},{key:"privateChannel",value:function(s){return this.channels["private-"+s]||(this.channels["private-"+s]=new hn(this.socket,"private-"+s,this.options)),this.channels["private-"+s]}},{key:"presenceChannel",value:function(s){return this.channels["presence-"+s]||(this.channels["presence-"+s]=new vs(this.socket,"presence-"+s,this.options)),this.channels["presence-"+s]}},{key:"leave",value:function(s){var l=this,h=[s,"private-"+s,"presence-"+s];h.forEach(function(C){l.leaveChannel(C)})}},{key:"leaveChannel",value:function(s){this.channels[s]&&(this.channels[s].unsubscribe(),delete this.channels[s])}},{key:"socketId",value:function(){return this.socket.id}},{key:"disconnect",value:function(){this.socket.disconnect()}}]),u}(Ce),ms=function(p){tt(u,p);var c=et(u);function u(){var a;return $(this,u),a=c.apply(this,arguments),a.channels={},a}return X(u,[{key:"connect",value:function(){}},{key:"listen",value:function(s,l,h){return new Jt}},{key:"channel",value:function(s){return new Jt}},{key:"privateChannel",value:function(s){return new tn}},{key:"encryptedPrivateChannel",value:function(s){return new tn}},{key:"presenceChannel",value:function(s){return new ys}},{key:"leave",value:function(s){}},{key:"leaveChannel",value:function(s){}},{key:"socketId",value:function(){return"fake-socket-id"}},{key:"disconnect",value:function(){}}]),u}(Ce),bs=function(){function p(c){$(this,p),this.options=c,this.connect(),this.options.withoutInterceptors||this.registerInterceptors()}return X(p,[{key:"channel",value:function(u){return this.connector.channel(u)}},{key:"connect",value:function(){this.options.broadcaster=="pusher"?this.connector=new gs(this.options):this.options.broadcaster=="socket.io"?this.connector=new _s(this.options):this.options.broadcaster=="null"?this.connector=new ms(this.options):typeof this.options.broadcaster=="function"&&(this.connector=new this.options.broadcaster(this.options))}},{key:"disconnect",value:function(){this.connector.disconnect()}},{key:"join",value:function(u){return this.connector.presenceChannel(u)}},{key:"leave",value:function(u){this.connector.leave(u)}},{key:"leaveChannel",value:function(u){this.connector.leaveChannel(u)}},{key:"leaveAllChannels",value:function(){for(var u in this.connector.channels)this.leaveChannel(u)}},{key:"listen",value:function(u,a,s){return this.connector.listen(u,a,s)}},{key:"private",value:function(u){return this.connector.privateChannel(u)}},{key:"encryptedPrivate",value:function(u){return this.connector.encryptedPrivateChannel(u)}},{key:"socketId",value:function(){return this.connector.socketId()}},{key:"registerInterceptors",value:function(){typeof Vue=="function"&&Vue.http&&this.registerVueRequestInterceptor(),typeof axios=="function"&&this.registerAxiosRequestInterceptor(),typeof jQuery=="function"&&this.registerjQueryAjaxSetup(),(typeof Turbo>"u"?"undefined":ye(Turbo))==="object"&&this.registerTurboRequestInterceptor()}},{key:"registerVueRequestInterceptor",value:function(){var u=this;Vue.http.interceptors.push(function(a,s){u.socketId()&&a.headers.set("X-Socket-ID",u.socketId()),s()})}},{key:"registerAxiosRequestInterceptor",value:function(){var u=this;axios.interceptors.request.use(function(a){return u.socketId()&&(a.headers["X-Socket-Id"]=u.socketId()),a})}},{key:"registerjQueryAjaxSetup",value:function(){var u=this;typeof jQuery.ajax<"u"&&jQuery.ajaxPrefilter(function(a,s,l){u.socketId()&&l.setRequestHeader("X-Socket-Id",u.socketId())})}},{key:"registerTurboRequestInterceptor",value:function(){var u=this;document.addEventListener("turbo:before-fetch-request",function(a){a.detail.fetchOptions.headers["X-Socket-Id"]=u.socketId()})}}]),p}();const ws={class:"fixed right-10 bottom-20"},Cs={class:"w-24 text-right"},Ss={class:"msg-content"},ks={class:"msg-time"},Ts={class:"mt-4",style:{"padding-left":"144px"}},xs=ct({__name:"ChatBox",setup(p){const c=jo(),u=rn(),a=en({}),{showBox:s,activeKey:l,hasNew:h,lastMessageId:C}=on(c);m();function m(){const b=u.identity===$t.Teacher?"teacher":"student";window.Pusher=us,window.Echo=new bs({broadcaster:"pusher",key:"6ac99e113826d5cf19c8",cluster:"mt1",encrypted:!0,occupied:!0,authEndpoint:`/api/${b}/broadcasting/auth`,auth:{headers:{authorization:`${u.token}`}}});const w=`${u.identity}-${u.userId}`,T=window.Echo.private(`chat.${w}`);T.listen(".message",g=>{if(C.value>=g.id)return;const d=g.from,y={self:!1,time:g.time,message:g.message};c.addMsg(d,y),c.setLastId(g.id),T.whisper("read",{id:g.id})}).listen(".notify",g=>{C.value>=g.id||(vo.open({class:"system-notify",message:"\u7CFB\u7EDF\u6D88\u606F",description:g.message,duration:null}),c.setLastId(g.id),T.whisper("read",{id:g.id}))})}function L(){if(!c.messageStore[l.value]||!a[l.value]){console.error("\u5F53\u524D\u4F1A\u8BDD\u4E0D\u5B58\u5728");return}const b=c.messageStore[l.value].user,w={self:!0,time:he().unix(),message:a[l.value]};c.addMsg(b,w),(u.identity===$t.Teacher?Co:So).sendMessages({identity:b.identity,user_id:b.id,message:a[l.value]}),a[l.value]=""}const P={};function k(b,w){P[b]=w}return me(c.messageStore,()=>{s.value&&_o(()=>{P[l.value].lastElementChild.scrollIntoView()})}),(b,w)=>{const T=ko,g=zt,d=Zo,y=Lo,x=Do,R=No,E=Po,N=Tt;return Z(),ut("div",null,[wt(V("div",ws,[O(T,{type:"primary",shape:"circle",size:"large",onClick:w[0]||(w[0]=j=>s.value=!0),class:"chat-btn"},{default:z(()=>[kt(" Chat ")]),_:1}),wt(O(g,{status:"processing",class:"newbd"},null,512),[[Ct,H(h)]])],512),[[Ct,!H(s)]]),wt(O(N,{title:"\u804A\u5929\u7A97",class:"fixed right-10 bottom-10 top-auto w-[800px] z-50"},{extra:z(()=>[O(T,{type:"link",size:"small",onClick:w[1]||(w[1]=j=>s.value=!1)},{default:z(()=>[O(d)]),_:1})]),default:z(()=>[O(R,{activeKey:H(l),"onUpdate:activeKey":w[2]||(w[2]=j=>yo(l)?l.value=j:null),"tab-position":"left",style:{height:"400px"}},{default:z(()=>[(Z(!0),ut(fe,null,Qe(H(c).messageStore,(j,q)=>(Z(),Ht(x,{key:q,style:{background:"#096dd966"}},{tab:z(()=>[V("div",Cs,[V("span",null,St(j.user.name),1),wt(O(g,{status:"processing",class:"checkbd"},null,512),[[Ct,j.unread]])])]),default:z(()=>[(Z(),ut("div",{class:"msg-main",ref_for:!0,ref:U=>{k(q,U)},key:q},[(Z(!0),ut(fe,null,Qe(j.list,U=>(Z(),ut("div",{class:go(["msg",{"msg-self":U.self}])},[V("div",Ss,St(U.message),1),V("div",ks,[O(y,{placement:"bottom",title:H(he)(U.time*1e3).format("YYYY/MM/DD HH:mm:ss")},{default:z(()=>[kt(St(H(he)(U.time*1e3).fromNow()),1)]),_:2},1032,["title"])])],2))),256))]))]),_:2},1024))),128))]),_:1},8,["activeKey"]),wt(V("div",Ts,[O(E,{value:a[H(l)],"onUpdate:value":w[3]||(w[3]=j=>a[H(l)]=j),style:{resize:"none"},"auto-size":{minRows:1,maxRows:5}},null,8,["value"]),O(T,{type:"primary",class:"float-right mt-4",onClick:L},{default:z(()=>[kt("\u53D1\u9001")]),_:1})],512),[[Ct,H(l)!==""]])]),_:1},512),[[Ct,H(s)]])])}}});const Ps=Mo(xs,[["__scopeId","data-v-eb14b67e"]]),Os={class:"h-full bg-slate-100"},Es={class:"h-full pt-12"},As={class:"h-full overflow-auto"},Vs=ct({__name:"index",setup(p){return(c,u)=>{const a=sn("router-view");return Z(),ut("div",Os,[O(as),V("div",Es,[V("div",As,[O(a)]),O(Ps)])])}}});export{Vs as default};
