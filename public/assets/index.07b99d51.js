import{d as ae,s as A,n as ne,a as l,r as ue,I as g,p as o,q as u,t as S,y as _,E as O,B as s,b as r,O as se,F as ie,a_ as le,G as V,C as x,m as $,x as w,D as y,a8 as re,aP as ce,aQ as _e}from"./index.961df8a6.js";import{u as de}from"./school.6f70861d.js";import{T as E,S as k,B as me}from"./api.2ab6e22f.js";import{u as pe}from"./chat.d6976b20.js";import{_ as fe}from"./index.47aba6c8.js";import{M as ve}from"./Modal.cb30d3e0.js";import{_ as he}from"./PlusOutlined.cd3a4c8d.js";import{_ as ge}from"./index.1ffd9047.js";import{I as ye}from"./Input.8160509c.js";import{_ as ke,F as Se}from"./Form.f09cf215.js";import{_ as Be}from"./_plugin-vue_export-helper.cdc0426e.js";import"./Dropdown.218e3c88.js";import"./index.b8c697d7.js";import"./index.2e28b626.js";import"./styleChecker.d9f39f59.js";import"./index.1ad696e1.js";import"./toArray.8eec5853.js";import"./index.d9b3a8e0.js";import"./Spin.5fd196d4.js";import"./debounce.1a9090d2.js";import"./Col.c84683db.js";const Ce=d=>(ce("data-v-735ea574"),d=d(),_e(),d),Fe={class:"mb-5"},xe={key:1,class:"text-lg font-bold"},we={key:0},Ee={key:1},Ie={key:2,class:"actions"},De=Ce(()=>S("a",{class:"red",href:"#"},"\u79FB\u9664",-1)),Te={key:1},be=["onClick"],Ne=["onClick"],Ae=ae({__name:"index",setup(d){const P=le(),I=de(),L=pe(),{curSchool:c}=A(I),{setCurSchool:M}=I,{identity:B}=A(ne()),C=l([]),m=l(!1),F=l(0),p=l(1),D=10,U=[{title:"ID",dataIndex:"id",key:"id"},{title:"\u59D3\u540D",dataIndex:"name",key:"name"},{title:"\u90AE\u7BB1",dataIndex:"username",key:"username"},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"created_at",key:"created_at"},{title:"\u6700\u8FD1\u66F4\u65B0",dataIndex:"updated_at",key:"updated_at"},{title:"\u64CD\u4F5C",dataIndex:"action",key:"action",width:180}],f=l(!1),v=l(!1),i=ue({username:""}),q={username:[{required:!0,message:"\u90AE\u7BB1\u5FC5\u586B"}]};H(),h();function h(){m.value=!0;const e={page:p.value,per_page:D};B.value==g.Teacher?E.getTeachersOfSchool(c.value.id,e).then(t=>{C.value=t.list,F.value=t.total}).finally(()=>m.value=!1):k.getTeachers(e).then(t=>{C.value=t.list,F.value=t.total}).finally(()=>m.value=!1)}function z(){i.username="",f.value=!0}function R(){if(!(v.value||!i.username))return new Promise(e=>{v.value=!0,E.inviteTeacher(c.value.id,i).then(()=>{f.value=!1,V.success("\u9080\u8BF7\u6210\u529F"),e(""),p.value=1,h()}).finally(()=>v.value=!1)})}function G(e){p.value=e,h()}function Q(e){E.removeTeacher(c.value.id,e).then(()=>{V.success("\u5220\u9664\u6210\u529F"),h()})}function j(e){e.is_followed=!e.is_followed,e.is_followed?k.followTeacher(e.id):k.unfollowTeacher(e.id)}function H(){P.name==="Student"&&!c.value&&k.getSchoolDetail().then(t=>{M(t)})}function J(e){L.openNewSession({identity:g.Teacher,id:e.id,name:e.name})}return(e,t)=>{var b;const K=he,W=me,X=ge,Y=fe,Z=ye,ee=ke,te=Se,oe=ve,T=re("time");return o(),u(ie,null,[S("div",{class:se(_(B)==_(g).Student?"p-5":"")},[S("div",Fe,[(b=_(c))!=null&&b.is_owner?(o(),O(W,{key:0,type:"primary",onClick:z},{icon:s(()=>[r(K)]),default:s(()=>[x(" \u9080\u8BF7\u6559\u5E08 ")]),_:1})):(o(),u("p",xe,"\u6559\u5E08\u5217\u8868"))]),r(Y,{dataSource:C.value,columns:U,loading:m.value,pagination:{position:["bottomCenter"],current:p.value,hideOnSinglePage:!0,pageSize:D,total:F.value,onChange:G}},{bodyCell:s(({column:a,record:n})=>[a.key==="created_at"?$((o(),u("span",we,[x(w(n.created_at),1)])),[[T]]):y("",!0),a.key==="updated_at"?$((o(),u("span",Ee,[x(w(n.updated_at),1)])),[[T]]):y("",!0),a.key==="action"?(o(),u("div",Ie,[_(B)==_(g).Teacher?(o(),O(X,{key:0,title:"\u786E\u5B9A\u8981\u79FB\u9664\u8BE5\u6559\u5E08\u5417?","ok-text":"\u79FB\u9664","cancel-text":"\u53D6\u6D88",onConfirm:N=>Q(n.id)},{default:s(()=>[De]),_:2},1032,["onConfirm"])):(o(),u("span",Te,[S("a",{href:"#",onClick:N=>j(n)},w(n.is_followed?"\u53D6\u6D88\u5173\u6CE8":"\u5173\u6CE8"),9,be),n?(o(),u("a",{key:0,href:"#",onClick:N=>J(n)},"\u804A\u5929",8,Ne)):y("",!0)]))])):y("",!0)]),_:1},8,["dataSource","loading","pagination"])],2),r(oe,{visible:f.value,"onUpdate:visible":t[1]||(t[1]=a=>f.value=a),title:"\u9080\u8BF7\u6559\u5E08","confirm-loading":v.value,onOk:R},{default:s(()=>[r(te,{model:i,rules:q},{default:s(()=>[r(ee,{label:"\u90AE\u7BB1",name:"username"},{default:s(()=>[r(Z,{value:i.username,"onUpdate:value":t[0]||(t[0]=a=>i.username=a),valueModifiers:{trim:!0},placeholder:"\u8F93\u5165\u90AE\u7BB1"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading"])],64)}}});const tt=Be(Ae,[["__scopeId","data-v-735ea574"]]);export{tt as default};
