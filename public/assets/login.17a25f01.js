import{d as k,a as L,n as A,G as c,p as l,q as _,t,m,v as h,b as s,B as n,a_ as w,aO as S,F as q,M as I,C as f,E as N,x as F,y as T,I as V}from"./index.e558b280.js";import{L as g,B as z}from"./api.77d9259c.js";import{_ as R,C as j,a as G}from"./Card.57d49227.js";import{S as H}from"./Spin.fb949baf.js";import"./index.2bb5e9bf.js";import"./index.23e6ad97.js";import"./Dropdown.bb8db13b.js";import"./Col.92aa9075.js";import"./styleChecker.cf36301e.js";import"./PlusOutlined.863c44e3.js";import"./debounce.e5eb5221.js";const M={class:"h-full bg-[#f0f2f5]"},O={class:"pt-[112px] pb-[24px] w-[1200px] mx-auto"},U={class:"text-center mt-10"},$=t("h3",{class:"text-2xl text-center mb-20"},"\u8BF7\u9009\u62E9\u5DF2\u7ED1\u5B9A\u8D26\u53F7",-1),J={class:"pt-4 border-0 border-t border-dotted border-gray-400 text-center"},re=k({__name:"login",setup(K){const B=w(),o=S(),a=B.query,r=L([]),u=A();D();function D(){if(a.state!=="loginedusys"||!a.code){c.error("\u56DE\u8C03\u4E0D\u5408\u6CD5\uFF0C\u767B\u9646\u5931\u8D25\uFF01"),o.push("/login");return}u.token?x():y()}function y(){g.login({code:a.code}).then(e=>{switch(e.tokens.length){case 0:u.bindHash=e.hash,c.error("\u6CA1\u6709\u7ED1\u5B9A\u8D26\u53F7\uFF0C\u8BF7\u767B\u5F55\u5DF2\u6709\u8D26\u53F7\u4EE5\u7ED1\u5B9ALine\u3002"),o.push("/login");break;case 1:d(e.tokens[0]);break;default:r.value=e.tokens;break}}).catch(()=>o.push("/login"))}function x(){g.bind({code:a.code,identity:u.identity,hash:null}).then(()=>{c.success("\u7ED1\u5B9ALine\u8D26\u53F7\u6210\u529F"),u.setBindLine(!0)}).catch(()=>{c.error("\u7ED1\u5B9A\u5931\u8D25\uFF0C\u8BF7\u9000\u51FA\u91CD\u8BD5")}).finally(()=>o.replace("/"))}function d(e){u.setLogin(e),u.setIdentity(e.identity),o.replace("/")}return(e,P)=>{const b=H,p=z,v=j,C=G,E=R;return l(),_("div",M,[t("div",O,[m(t("div",U,[s(b,{size:"large"})],512),[[h,r.value.length===0]]),m(t("div",null,[$,s(E,{type:"flex",justify:"center",gutter:50},{default:n(()=>[(l(!0),_(q,null,I(r.value,i=>(l(),N(C,{span:8,class:"mb-[50px]"},{default:n(()=>[s(v,{title:i.username},{extra:n(()=>[s(p,{type:"primary",onClick:Q=>d(i)},{default:n(()=>[f("\u767B\u5F55")]),_:2},1032,["onClick"])]),default:n(()=>[t("p",null,F(i.identity===T(V).Teacher?"\u6559\u5E08":"\u5B66\u751F"),1),t("p",null,F(i.name),1)]),_:2},1032,["title"])]),_:2},1024))),256))]),_:1}),t("div",J,[s(p,{href:"/login",size:"large"},{default:n(()=>[f("\u53D6\u6D88")]),_:1})])],512),[[h,r.value.length>0]])])])}}});export{re as default};
